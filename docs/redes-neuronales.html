<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 Redes Neuronales | Análisis de series temporales: Ausentismo laboral</title>
  <meta name="description" content="Este es un ejemplo aplicado de análisis de series temporales usando la base de datos de ausentismo laboral disponible en UCI" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 Redes Neuronales | Análisis de series temporales: Ausentismo laboral" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Este es un ejemplo aplicado de análisis de series temporales usando la base de datos de ausentismo laboral disponible en UCI" />
  <meta name="github-repo" content="https://github.com/rortizgeo/TS_bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 Redes Neuronales | Análisis de series temporales: Ausentismo laboral" />
  
  <meta name="twitter:description" content="Este es un ejemplo aplicado de análisis de series temporales usando la base de datos de ausentismo laboral disponible en UCI" />
  

<meta name="author" content="Ricardo Ortiz; Jaime Martinez, Jeisson Rodriguez" />


<meta name="date" content="2025-06-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="references.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script src="libs/Dygraph.Plugins.Unzoom-1.0/unzoom.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis de series temporales</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="ausentismo-laboral.html"><a href="ausentismo-laboral.html"><i class="fa fa-check"></i><b>1</b> AUSENTISMO LABORAL</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ausentismo-laboral.html"><a href="ausentismo-laboral.html#introducción"><i class="fa fa-check"></i><b>1.1</b> Introducción</a></li>
<li class="chapter" data-level="1.2" data-path="ausentismo-laboral.html"><a href="ausentismo-laboral.html#finalidad-del-estudio"><i class="fa fa-check"></i><b>1.2</b> Finalidad del estudio</a></li>
<li class="chapter" data-level="1.3" data-path="ausentismo-laboral.html"><a href="ausentismo-laboral.html#diseño-del-estudio"><i class="fa fa-check"></i><b>1.3</b> Diseño del estudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="análisis-de-los-datos.html"><a href="análisis-de-los-datos.html"><i class="fa fa-check"></i><b>2</b> Análisis de los datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="análisis-de-los-datos.html"><a href="análisis-de-los-datos.html#media-movil"><i class="fa fa-check"></i><b>2.1</b> Media Movil</a></li>
<li class="chapter" data-level="2.2" data-path="análisis-de-los-datos.html"><a href="análisis-de-los-datos.html#rezagos"><i class="fa fa-check"></i><b>2.2</b> Rezagos</a></li>
<li class="chapter" data-level="2.3" data-path="análisis-de-los-datos.html"><a href="análisis-de-los-datos.html#análísis-de-estacionalidad"><i class="fa fa-check"></i><b>2.3</b> Análísis de estacionalidad</a></li>
<li class="chapter" data-level="2.4" data-path="análisis-de-los-datos.html"><a href="análisis-de-los-datos.html#descomposición-de-la-serie-temporal"><i class="fa fa-check"></i><b>2.4</b> Descomposición de la serie temporal</a></li>
<li class="chapter" data-level="2.5" data-path="análisis-de-los-datos.html"><a href="análisis-de-los-datos.html#estacionariedad"><i class="fa fa-check"></i><b>2.5</b> Estacionariedad</a></li>
<li class="chapter" data-level="2.6" data-path="análisis-de-los-datos.html"><a href="análisis-de-los-datos.html#diferenciación"><i class="fa fa-check"></i><b>2.6</b> Diferenciación</a></li>
<li class="chapter" data-level="2.7" data-path="análisis-de-los-datos.html"><a href="análisis-de-los-datos.html#conclusión"><i class="fa fa-check"></i><b>2.7</b> Conclusión</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="predicciones.html"><a href="predicciones.html"><i class="fa fa-check"></i><b>3</b> Predicciones</a>
<ul>
<li class="chapter" data-level="3.1" data-path="predicciones.html"><a href="predicciones.html#método-holt-winters"><i class="fa fa-check"></i><b>3.1</b> Método Holt-Winters</a></li>
<li class="chapter" data-level="3.2" data-path="predicciones.html"><a href="predicciones.html#predicción-próximos-7-días"><i class="fa fa-check"></i><b>3.2</b> Predicción próximos 7 días</a></li>
<li class="chapter" data-level="3.3" data-path="predicciones.html"><a href="predicciones.html#conclusión-aplicacion-metodología-holt-winters"><i class="fa fa-check"></i><b>3.3</b> Conclusión aplicacion metodología Holt-Winters</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelo-arima.html"><a href="modelo-arima.html"><i class="fa fa-check"></i><b>4</b> Modelo ARIMA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelo-arima.html"><a href="modelo-arima.html#generación-del-modelo"><i class="fa fa-check"></i><b>4.1</b> Generación del modelo</a></li>
<li class="chapter" data-level="4.2" data-path="modelo-arima.html"><a href="modelo-arima.html#análisis-de-los-residuos"><i class="fa fa-check"></i><b>4.2</b> Análisis de los residuos</a></li>
<li class="chapter" data-level="4.3" data-path="modelo-arima.html"><a href="modelo-arima.html#punto-de-cambio-amoc"><i class="fa fa-check"></i><b>4.3</b> Punto de cambio (AMOC)</a></li>
<li class="chapter" data-level="4.4" data-path="modelo-arima.html"><a href="modelo-arima.html#predicción"><i class="fa fa-check"></i><b>4.4</b> Predicción</a></li>
<li class="chapter" data-level="4.5" data-path="modelo-arima.html"><a href="modelo-arima.html#conclusiones"><i class="fa fa-check"></i><b>4.5</b> Conclusiones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelo-prophet.html"><a href="modelo-prophet.html"><i class="fa fa-check"></i><b>5</b> Modelo Prophet</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelo-prophet.html"><a href="modelo-prophet.html#generacion-del-modelo"><i class="fa fa-check"></i><b>5.1</b> Generacion del modelo</a></li>
<li class="chapter" data-level="5.2" data-path="modelo-prophet.html"><a href="modelo-prophet.html#predicción-1"><i class="fa fa-check"></i><b>5.2</b> Predicción</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="capitulo-6-comparacion-de-modelos.html"><a href="capitulo-6-comparacion-de-modelos.html"><i class="fa fa-check"></i><b>6</b> Capitulo 6 Comparacion de modelos</a>
<ul>
<li class="chapter" data-level="6.1" data-path="capitulo-6-comparacion-de-modelos.html"><a href="capitulo-6-comparacion-de-modelos.html#métricas-a-implementar"><i class="fa fa-check"></i><b>6.1</b> Métricas a implementar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="7" data-path="redes-neuronales.html"><a href="redes-neuronales.html"><i class="fa fa-check"></i><b>7</b> Redes Neuronales</a>
<ul>
<li class="chapter" data-level="7.1" data-path="redes-neuronales.html"><a href="redes-neuronales.html#redes-neuronales-elman"><i class="fa fa-check"></i><b>7.1</b> Redes neuronales: ELMAN</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="redes-neuronales.html"><a href="redes-neuronales.html#desempeño-del-modelo-elman-con-datos-de-entrenamiento."><i class="fa fa-check"></i><b>7.1.1</b> Desempeño del modelo ELMAN con datos de entrenamiento.</a></li>
<li class="chapter" data-level="7.1.2" data-path="redes-neuronales.html"><a href="redes-neuronales.html#desempeño-del-modelo-elman-con-datos-de-prueba."><i class="fa fa-check"></i><b>7.1.2</b> Desempeño del modelo ELMAN con datos de prueba.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="redes-neuronales.html"><a href="redes-neuronales.html#redes-neuronales-jordan"><i class="fa fa-check"></i><b>7.2</b> Redes neuronales: JORDAN</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="redes-neuronales.html"><a href="redes-neuronales.html#desempeño-del-modelo-jordan-con-datos-de-entrenamiento."><i class="fa fa-check"></i><b>7.2.1</b> Desempeño del modelo JORDAN con datos de entrenamiento.</a></li>
<li class="chapter" data-level="7.2.2" data-path="redes-neuronales.html"><a href="redes-neuronales.html#desempeño-del-modelo-jordan-con-datos-de-prueba."><i class="fa fa-check"></i><b>7.2.2</b> Desempeño del modelo JORDAN con datos de prueba.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="redes-neuronales.html"><a href="redes-neuronales.html#rendimiento-redes-elman-y-jordan"><i class="fa fa-check"></i><b>7.3</b> Rendimiento Redes ELMAN y JORDAN</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="redes-neuronales.html"><a href="redes-neuronales.html#rendimiento-elman"><i class="fa fa-check"></i><b>7.3.1</b> Rendimiento ELMAN</a></li>
<li class="chapter" data-level="7.3.2" data-path="redes-neuronales.html"><a href="redes-neuronales.html#rendimiento-jordan"><i class="fa fa-check"></i><b>7.3.2</b> Rendimiento Jordan</a></li>
<li class="chapter" data-level="7.3.3" data-path="redes-neuronales.html"><a href="redes-neuronales.html#conclusión-1"><i class="fa fa-check"></i><b>7.3.3</b> Conclusión</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rortizgeo/TS_bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de series temporales: Ausentismo laboral</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="redes-neuronales" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Capítulo 7</span> Redes Neuronales<a href="redes-neuronales.html#redes-neuronales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Mediante el uso de modelos con series neuronales se puede tener una arquitectura que genera una memoria con sentido temporal lo que lo hace aplicable a las series de tiempo, se pueden tener varias neuronas que registran entradas y generan salidas a las capas del modelo, estas conexiones arbitrarias entre las neuronas permiten crear ciclos y temporalidad. Existen diferentes tipos de modelos de redes neuronales dependiendo de la forma como están dispuestas las entradas y las salida, los mas conocidos son la red neuronal recurrente (ELMAN) y la red neuronal con memoria a corto plazo (Jordan).</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="redes-neuronales.html#cb68-1" tabindex="-1"></a><span class="co">#Debido a las transformaciones realizadas anteriormente en ts_diaria, se redefine nuevamente para evitar conflicto con la clase del objeto en las operaciones posteriores. </span></span>
<span id="cb68-2"><a href="redes-neuronales.html#cb68-2" tabindex="-1"></a></span>
<span id="cb68-3"><a href="redes-neuronales.html#cb68-3" tabindex="-1"></a><span class="co"># Agrupar por fecha y sumar las horas de ausencia (puede haber varias por día)</span></span>
<span id="cb68-4"><a href="redes-neuronales.html#cb68-4" tabindex="-1"></a>serie_diaria <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="redes-neuronales.html#cb68-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Fecha)) <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="redes-neuronales.html#cb68-6" tabindex="-1"></a>  <span class="fu">group_by</span>(Fecha) <span class="sc">%&gt;%</span></span>
<span id="cb68-7"><a href="redes-neuronales.html#cb68-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Horas =</span> <span class="fu">sum</span>(Absenteeism.time.in.hours, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-8"><a href="redes-neuronales.html#cb68-8" tabindex="-1"></a>  <span class="fu">arrange</span>(Fecha)</span>
<span id="cb68-9"><a href="redes-neuronales.html#cb68-9" tabindex="-1"></a></span>
<span id="cb68-10"><a href="redes-neuronales.html#cb68-10" tabindex="-1"></a><span class="co"># Rellenar fechas faltantes (por si hay días sin datos)</span></span>
<span id="cb68-11"><a href="redes-neuronales.html#cb68-11" tabindex="-1"></a>todas_las_fechas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-12"><a href="redes-neuronales.html#cb68-12" tabindex="-1"></a>  <span class="at">Fecha =</span> <span class="fu">seq.Date</span>(<span class="fu">min</span>(serie_diaria<span class="sc">$</span>Fecha), <span class="fu">max</span>(serie_diaria<span class="sc">$</span>Fecha), <span class="at">by =</span> <span class="st">&quot;day&quot;</span>)</span>
<span id="cb68-13"><a href="redes-neuronales.html#cb68-13" tabindex="-1"></a>)</span>
<span id="cb68-14"><a href="redes-neuronales.html#cb68-14" tabindex="-1"></a></span>
<span id="cb68-15"><a href="redes-neuronales.html#cb68-15" tabindex="-1"></a>serie_diaria <span class="ot">&lt;-</span> todas_las_fechas <span class="sc">%&gt;%</span></span>
<span id="cb68-16"><a href="redes-neuronales.html#cb68-16" tabindex="-1"></a>  <span class="fu">left_join</span>(serie_diaria, <span class="at">by =</span> <span class="st">&quot;Fecha&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-17"><a href="redes-neuronales.html#cb68-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Horas =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Horas), <span class="dv">0</span>, Horas))</span>
<span id="cb68-18"><a href="redes-neuronales.html#cb68-18" tabindex="-1"></a></span>
<span id="cb68-19"><a href="redes-neuronales.html#cb68-19" tabindex="-1"></a>ts_diaria <span class="ot">&lt;-</span> <span class="fu">ts</span>(serie_diaria<span class="sc">$</span>Horas, <span class="at">frequency =</span> <span class="dv">7</span>)</span></code></pre></div>
<p>En este ejercicio se trabaja nuevamente con la serie ts_diaria construida en el capítulo 2.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="redes-neuronales.html#cb69-1" tabindex="-1"></a><span class="fu">class</span>(ts_diaria)</span></code></pre></div>
<pre><code>## [1] &quot;ts&quot;</code></pre>
<p>Para el uso de redes neuronales se requiere de la normalización de los datos en formato serie de tiempo. A continuación se realiza la respectiva normalización.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="redes-neuronales.html#cb71-1" tabindex="-1"></a>ts_norm <span class="ot">&lt;-</span> (ts_diaria<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">/</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))  </span>
<span id="cb71-2"><a href="redes-neuronales.html#cb71-2" tabindex="-1"></a><span class="fu">plot</span>(ts_norm, <span class="at">main=</span><span class="st">&quot;Serie de tiempo ausentismo datos normalizados&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Z&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/normalizacion_ausentismo-1.png" width="672" />
Ahora comprobamos el tamaño del dataset para definir el tamaño del conjunto de datos de entrenamiento y de prueba.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="redes-neuronales.html#cb72-1" tabindex="-1"></a><span class="co">#Se comprueba el numero de filas totales del dataset.</span></span>
<span id="cb72-2"><a href="redes-neuronales.html#cb72-2" tabindex="-1"></a>tamano_total<span class="ot">&lt;-</span><span class="fu">length</span>(ts_norm)</span>
<span id="cb72-3"><a href="redes-neuronales.html#cb72-3" tabindex="-1"></a>tamano_total</span></code></pre></div>
<pre><code>## [1] 365</code></pre>
<p>Se define el conjunto de entrenamiento.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="redes-neuronales.html#cb74-1" tabindex="-1"></a><span class="co">#definicion set de entrenamiento</span></span>
<span id="cb74-2"><a href="redes-neuronales.html#cb74-2" tabindex="-1"></a>tamano_train <span class="ot">&lt;-</span> <span class="fu">round</span>(tamano_total<span class="sc">*</span><span class="fl">0.8</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb74-3"><a href="redes-neuronales.html#cb74-3" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(tamano_train<span class="dv">-1</span>)</span>
<span id="cb74-4"><a href="redes-neuronales.html#cb74-4" tabindex="-1"></a>train</span></code></pre></div>
<pre><code>##   [1]   0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
##  [19]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35
##  [37]  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53
##  [55]  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71
##  [73]  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89
##  [91]  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
## [109] 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
## [127] 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
## [145] 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
## [163] 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
## [181] 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
## [199] 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215
## [217] 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233
## [235] 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251
## [253] 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269
## [271] 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287
## [289] 288 289 290 291</code></pre>
<p>Se define el conjunto de prueba</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="redes-neuronales.html#cb76-1" tabindex="-1"></a><span class="co">#definicion set de prueba</span></span>
<span id="cb76-2"><a href="redes-neuronales.html#cb76-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> (tamano_train)<span class="sc">:</span>tamano_total</span>
<span id="cb76-3"><a href="redes-neuronales.html#cb76-3" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>##  [1] 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310
## [20] 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
## [39] 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348
## [58] 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365</code></pre>
<p>Se crea un marco de datos con n columnas, cada una de las cuales se construye avanzando un valor de la serie en el futuro, a través de una variable de tipo zoo.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="redes-neuronales.html#cb78-1" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">as.zoo</span>(ts_norm)</span>
<span id="cb78-2"><a href="redes-neuronales.html#cb78-2" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb78-3"><a href="redes-neuronales.html#cb78-3" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb78-4"><a href="redes-neuronales.html#cb78-4" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb78-5"><a href="redes-neuronales.html#cb78-5" tabindex="-1"></a>x4<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb78-6"><a href="redes-neuronales.html#cb78-6" tabindex="-1"></a>x5<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">5</span>)</span>
<span id="cb78-7"><a href="redes-neuronales.html#cb78-7" tabindex="-1"></a>x6<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">6</span>)</span>
<span id="cb78-8"><a href="redes-neuronales.html#cb78-8" tabindex="-1"></a>x7<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">7</span>)</span>
<span id="cb78-9"><a href="redes-neuronales.html#cb78-9" tabindex="-1"></a>x8<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">8</span>)</span>
<span id="cb78-10"><a href="redes-neuronales.html#cb78-10" tabindex="-1"></a>x9<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">9</span>)</span>
<span id="cb78-11"><a href="redes-neuronales.html#cb78-11" tabindex="-1"></a>x10<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">10</span>)</span>
<span id="cb78-12"><a href="redes-neuronales.html#cb78-12" tabindex="-1"></a>x11 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">11</span>)</span>
<span id="cb78-13"><a href="redes-neuronales.html#cb78-13" tabindex="-1"></a>x12 <span class="ot">&lt;-</span> <span class="fu">Lag</span>(y, <span class="at">k =</span> <span class="dv">12</span>)</span>
<span id="cb78-14"><a href="redes-neuronales.html#cb78-14" tabindex="-1"></a>ts_norm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12)</span></code></pre></div>
<p>Se eliminan los valoers NA que pueden desplazar la serie</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="redes-neuronales.html#cb79-1" tabindex="-1"></a><span class="fu">anyNA</span>(ts_norm)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="redes-neuronales.html#cb81-1" tabindex="-1"></a>ts_norm_Lag <span class="ot">&lt;-</span> ts_norm[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>),]</span>
<span id="cb81-2"><a href="redes-neuronales.html#cb81-2" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(ts_norm_Lag)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-d155068b2961e07cd616" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d155068b2961e07cd616">{"x":{"filter":"none","vertical":false,"data":[[0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0,0,0.0119047619047619,0.04761904761904762,0.1011904761904762,0.04166666666666666,0,0,0.06547619047619048],[0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0,0,0.0119047619047619,0.04761904761904762,0.1011904761904762,0.04166666666666666,0,0],[0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0,0,0.0119047619047619,0.04761904761904762,0.1011904761904762,0.04166666666666666,0],[0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0,0,0.0119047619047619,0.04761904761904762,0.1011904761904762,0.04166666666666666],[0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0,0,0.0119047619047619,0.04761904761904762,0.1011904761904762],[0.2380952380952381,0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0,0,0.0119047619047619,0.04761904761904762],[0,0.2380952380952381,0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0,0,0.0119047619047619],[0,0,0.2380952380952381,0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0,0],[0.0119047619047619,0,0,0.2380952380952381,0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0,0],[0.02380952380952381,0.0119047619047619,0,0,0.2380952380952381,0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381,0],[0.04761904761904762,0.02380952380952381,0.0119047619047619,0,0,0.2380952380952381,0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0,0.02380952380952381],[0.0119047619047619,0.04761904761904762,0.02380952380952381,0.0119047619047619,0,0,0.2380952380952381,0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762,0],[0.02976190476190476,0.0119047619047619,0.04761904761904762,0.02380952380952381,0.0119047619047619,0,0,0.2380952380952381,0.04166666666666666,0.04761904761904762,0.09523809523809523,0.02380952380952381,0,0,0.1607142857142857,0.04761904761904762,0.01785714285714286,0.08333333333333333,0.0119047619047619,0,0,0.08333333333333333,0.1071428571428571,0.0119047619047619,0.04761904761904762,0.01785714285714286,0,0,0.0119047619047619,0.05952380952380952,0.08928571428571429,0.02976190476190476,0.1666666666666667,0,0,0.08333333333333333,0.130952380952381,0.09523809523809523,0.119047619047619,0.05357142857142857,0,0,0.1071428571428571,0.06547619047619048,0.04166666666666666,0.07738095238095238,0.1428571428571428,0,0,0.07738095238095238,0.02976190476190476,0.08333333333333333,0.1428571428571428,0.02976190476190476,0,0,0.0119047619047619,0.07738095238095238,0.1845238095238095,0.07738095238095238,0.05357142857142857,0,0,0.2797619047619048,0.04761904761904762,0.2380952380952381,0,0.07142857142857142,0,0,0.3988095238095238,0.2738095238095238,0.125,0.04761904761904762,0.04761904761904762,0,0,0.130952380952381,0.08928571428571429,0.2142857142857143,0.2083333333333333,0.3154761904761905,0,0,0.75,0.9047619047619048,0.1845238095238095,0.06547619047619048,0.02976190476190476,0,0,0.07142857142857142,0.1011904761904762,0.8630952380952381,0.04761904761904762,0.4583333333333333,0,0,0.1428571428571428,0.01785714285714286,0.02976190476190476,0.0119047619047619,0.2023809523809524,0,0,0.07142857142857142,0.04166666666666666,0.1071428571428571,0.1488095238095238,0.0119047619047619,0,0,0.02976190476190476,0.02380952380952381,0.3928571428571428,0.005952380952380952,0.04166666666666666,0,0,0.04761904761904762,0,0.119047619047619,0.0119047619047619,0.5892857142857143,0,0,0.0119047619047619,0.04761904761904762,0.07738095238095238,0.05952380952380952,0,0,0,0.5059523809523809,0.05952380952380952,0.2559523809523809,0.005952380952380952,0.01785714285714286,0,0,0.04761904761904762,0.01785714285714286,0.1130952380952381,0,0.05952380952380952,0,0,0.1369047619047619,0.005952380952380952,0.1607142857142857,0.07738095238095238,0.1071428571428571,0,0,0.09523809523809523,0.005952380952380952,0.4761904761904762,0.08928571428571429,0.1547619047619048,0,0,0.04761904761904762,0.09523809523809523,0.04761904761904762,0.08333333333333333,0.0119047619047619,0,0,0.3095238095238095,0.1607142857142857,0.04761904761904762,0.02380952380952381,0.03571428571428571,0,0,0.2619047619047619,0.01785714285714286,0.1845238095238095,0.1904761904761905,0,0,0,0.3869047619047619,0.7142857142857143,0.119047619047619,0.04761904761904762,0.1369047619047619,0,0,0.2380952380952381,0.1428571428571428,0.0119047619047619,0.130952380952381,0.09523809523809523,0,0,0.07142857142857142,0.03571428571428571,0.1130952380952381,0.03571428571428571,0.02380952380952381,0,0,0.09523809523809523,0.8928571428571429,0.07142857142857142,0.06547619047619048,0.1785714285714286,0,0,0.6130952380952381,0.1488095238095238,0.07738095238095238,0.07738095238095238,0.04166666666666666,0,0,0.03571428571428571,0.08333333333333333,0.04761904761904762,0.1369047619047619,0,0,0,0.3035714285714285,0.1011904761904762,0.05952380952380952,0.119047619047619,0.02380952380952381,0,0,0.119047619047619,0.07142857142857142,0,0.01785714285714286,0.04761904761904762,0,0,0.05357142857142857,0.1726190476190476,0,0.04166666666666666,0.08333333333333333,0,0,0.3273809523809524,0.01785714285714286,0.06547619047619048,0.02976190476190476,0.1428571428571428,0,0,0.03571428571428571,0.07142857142857142,0.1607142857142857,0,0.05357142857142857,0,0,0.1428571428571428,0.03571428571428571,0.01785714285714286,0.01785714285714286,0.01785714285714286,0,0,0.1904761904761905,0.1547619047619048,0.2380952380952381,0,0.01785714285714286,0,0,0.05952380952380952,0.06547619047619048,0.02380952380952381,0.2202380952380952,0.1369047619047619,0,0,0.1369047619047619,0.05357142857142857,0.0119047619047619,0.1369047619047619,0.04166666666666666,0,0,0.09523809523809523,0.07142857142857142,0.4404761904761905,0.06547619047619048,0.01785714285714286,0,0,0.05952380952380952,0.125,0.1428571428571428,0,0.04761904761904762,0,0,0.09523809523809523,0.005952380952380952,0.02380952380952381,0.05357142857142857,0.04761904761904762,0,0,0.02380952380952381,0.01785714285714286,0.2261904761904762,0.01785714285714286,0.07142857142857142,0,0,1,0.01785714285714286,0.1428571428571428,0.08928571428571429,0.1428571428571428,0,0,0.1607142857142857,0.1011904761904762,0.06547619047619048,0.04761904761904762,0.05357142857142857,0,0,0.2857142857142857,0.09523809523809523,0.07738095238095238,0.02976190476190476,0.04761904761904762,0,0,0,0.0119047619047619,0.09523809523809523,0.01785714285714286,0.05357142857142857,0,0,0.0119047619047619,0.9464285714285714,0.05357142857142857,0.01785714285714286,0.1369047619047619,0,0,0.1130952380952381,0.6666666666666666,0.04761904761904762]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>y<\/th>\n      <th>Lag.1<\/th>\n      <th>Lag.2<\/th>\n      <th>Lag.3<\/th>\n      <th>Lag.4<\/th>\n      <th>Lag.5<\/th>\n      <th>Lag.6<\/th>\n      <th>Lag.7<\/th>\n      <th>Lag.8<\/th>\n      <th>Lag.9<\/th>\n      <th>Lag.10<\/th>\n      <th>Lag.11<\/th>\n      <th>Lag.12<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12]},{"name":"y","targets":0},{"name":"Lag.1","targets":1},{"name":"Lag.2","targets":2},{"name":"Lag.3","targets":3},{"name":"Lag.4","targets":4},{"name":"Lag.5","targets":5},{"name":"Lag.6","targets":6},{"name":"Lag.7","targets":7},{"name":"Lag.8","targets":8},{"name":"Lag.9","targets":9},{"name":"Lag.10","targets":10},{"name":"Lag.11","targets":11},{"name":"Lag.12","targets":12}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="redes-neuronales.html#cb82-1" tabindex="-1"></a><span class="fu">anyNA</span>(ts_norm_Lag)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Se definen por conveniencia los valores de entrada y salida de la red neuronal.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="redes-neuronales.html#cb84-1" tabindex="-1"></a><span class="co">#Luego definimos los valores de entrada y salida de la red neuronal:</span></span>
<span id="cb84-2"><a href="redes-neuronales.html#cb84-2" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> ts_norm_Lag[,<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb84-3"><a href="redes-neuronales.html#cb84-3" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> ts_norm_Lag[,<span class="dv">1</span>]</span></code></pre></div>
<div id="redes-neuronales-elman" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Redes neuronales: ELMAN<a href="redes-neuronales.html#redes-neuronales-elman" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Se crea una red tipo ELMAN y proceder a entrenarla con los datos previamente definidos.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="redes-neuronales.html#cb85-1" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">elman</span>(inputs[train],</span>
<span id="cb85-2"><a href="redes-neuronales.html#cb85-2" tabindex="-1"></a> outputs[train],</span>
<span id="cb85-3"><a href="redes-neuronales.html#cb85-3" tabindex="-1"></a> <span class="at">size=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>),</span>
<span id="cb85-4"><a href="redes-neuronales.html#cb85-4" tabindex="-1"></a> <span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb85-5"><a href="redes-neuronales.html#cb85-5" tabindex="-1"></a> <span class="at">maxit=</span><span class="dv">10000</span>)</span></code></pre></div>
<p>El tercer parámetro indica que queremos crear cincto capas ocultas, una con cinco neuronas y así sucesivamente hasta una última capa con una neurona. Esto se ajustó al ver que el rendimiento del modelo aplicando solo dos capas no era adecuado. Además, indicamos una tasa de aprendizaje de 1, y también un número máximo de iteraciones de 10.000.</p>
<p>Con la función <em>plotIterativeError</em> podemos ver cómo ha evolucionado el error de red a lo largo de las iteraciones de entrenamiento y se encuentra que este tiende a 0,esto indica que el modelo ha logrado aprender una representación correcta de los datos.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="redes-neuronales.html#cb86-1" tabindex="-1"></a><span class="fu">plotIterativeError</span>(fit)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Ahora se realiza una evaluación del modelo solo sobre el conjunto de entrenamiento. Esto es útil para evaluar el overfitting (comparando errores en entrenamiento vs prueba).</p>
<div id="desempeño-del-modelo-elman-con-datos-de-entrenamiento." class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Desempeño del modelo ELMAN con datos de entrenamiento.<a href="redes-neuronales.html#desempeño-del-modelo-elman-con-datos-de-entrenamiento." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="redes-neuronales.html#cb87-1" tabindex="-1"></a><span class="co"># Se elimina el conjunto de test de las entradas y salidas de las neuronas para realizar el ajuste del modelo a los datos reales</span></span>
<span id="cb87-2"><a href="redes-neuronales.html#cb87-2" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>test])</span>
<span id="cb87-3"><a href="redes-neuronales.html#cb87-3" tabindex="-1"></a>predtrain1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, inputs[<span class="sc">-</span>test])</span></code></pre></div>
<p>Aunque los modelos (como redes neuronales) aprenden mejor con datos normalizados, la evaluación y la interpretación de resultados (por ejemplo, errores absolutos, visualización de predicciones) deben hacerse en la escala original para que tengan sentido.</p>
<p>El siguiente código realiza el proceso conocido como “desnormalización” o “re-escalado inverso” de los datos que han sido previamente normalizados.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="redes-neuronales.html#cb88-1" tabindex="-1"></a>y_train<span class="ot">&lt;-</span>y_train<span class="sc">*</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">+</span><span class="fu">min</span>(ts_diaria)</span>
<span id="cb88-2"><a href="redes-neuronales.html#cb88-2" tabindex="-1"></a>predtrain1<span class="ot">&lt;-</span>predtrain1<span class="sc">*</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">+</span><span class="fu">min</span>(ts_diaria)</span></code></pre></div>
<p>El gráfico muestra el ajuste del modelo de red neuronal ELMAN sobre los datos del conjunto de entrenamiento. La línea negra representa los valores reales del fenómeno analizado (en este caso, el ausentismo normalizado), mientras que la línea roja corresponde a las predicciones generadas por el modelo para esas mismas observaciones. Un buen ajuste se refleja en que ambas líneas estén cercanas y sigan una trayectoria similar, lo que indica que el modelo ha aprendido correctamente la estructura de los datos.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="redes-neuronales.html#cb89-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">length</span>(y_train), <span class="fu">length</span>(predtrain1))</span>
<span id="cb89-2"><a href="redes-neuronales.html#cb89-2" tabindex="-1"></a></span>
<span id="cb89-3"><a href="redes-neuronales.html#cb89-3" tabindex="-1"></a>pt1 <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">y =</span> y_train[<span class="dv">1</span><span class="sc">:</span>n], <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>,</span>
<span id="cb89-4"><a href="redes-neuronales.html#cb89-4" tabindex="-1"></a>               <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>), <span class="at">name =</span> <span class="st">&#39;Datos reales&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="redes-neuronales.html#cb89-5" tabindex="-1"></a>  plotly<span class="sc">::</span><span class="fu">add_lines</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">y =</span> predtrain1[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb89-6"><a href="redes-neuronales.html#cb89-6" tabindex="-1"></a>            <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;red&#39;</span>), <span class="at">name =</span> <span class="st">&#39;Predicciones&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-7"><a href="redes-neuronales.html#cb89-7" tabindex="-1"></a>  plotly<span class="sc">::</span><span class="fu">layout</span>(</span>
<span id="cb89-8"><a href="redes-neuronales.html#cb89-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Ajuste de las predicciones modelo ELMAN en datos de entrenamiento&quot;</span>,</span>
<span id="cb89-9"><a href="redes-neuronales.html#cb89-9" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Observación&quot;</span>),</span>
<span id="cb89-10"><a href="redes-neuronales.html#cb89-10" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Ausentismo normalizado&quot;</span>)</span>
<span id="cb89-11"><a href="redes-neuronales.html#cb89-11" tabindex="-1"></a>  )</span>
<span id="cb89-12"><a href="redes-neuronales.html#cb89-12" tabindex="-1"></a></span>
<span id="cb89-13"><a href="redes-neuronales.html#cb89-13" tabindex="-1"></a>pt1</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-4345e01eba9e10bdf0e6" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4345e01eba9e10bdf0e6">{"x":{"visdat":{"11f46265c4292":["function () ","plotlyVisDat"]},"cur_data":"11f46265c4292","attrs":{"11f46265c4292":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291],"y":[0,0,27.000000000000004,8,3,14,2,0,0,14,18,2,8,3,0,0,2,10,15,5,28,0,0,14,22,16,20,9,0,0,18,11,7,13,24,0,0,13,5,14,24,5,0,0,2,13,31,13,9,0,0,47,8,40,0,12,0,0,67,46.000000000000007,21,8,8,0,0,22,15,36,35,53,0,0,126,152,31,11,5,0,0,12,17,145,8,77,0,0,24,3,5,2,34,0,0,12,7,18,25,2,0,0,5,4,66,1,7,0,0,8,0,20,2,99,0,0,2,8,13,10,0,0,0,85,10,43,1,3,0,0,8,3,19,0,10,0,0,23.000000000000004,1,27.000000000000004,13,18,0,0,16,1,80,15,26,0,0,8,16,8,14,2,0,0,52,27.000000000000004,8,4,6,0,0,44,3,31,32,0,0,0,65,120,20,8,23.000000000000004,0,0,40,24,2,22,16,0,0,12,6,19,6,4,0,0,16,150,12,11,30,0,0,103,25,13,13,7,0,0,6,14,8,23.000000000000004,0,0,0,50.999999999999993,17,10,20,4,0,0,20,12,0,3,8,0,0,9,29,0,7,14,0,0,55,3,11,5,24,0,0,6,12,27.000000000000004,0,9,0,0,24,6,3,3,3,0,0,32,26,40,0,3,0,0,10,11,4,37,23.000000000000004,0,0,23.000000000000004,9,2,23.000000000000004,7,0,0,16,12,74,11,3,0,0,10,21,24,0,8,0,0,16,1],"mode":"lines","line":{"color":"black"},"name":"Datos reales","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"11f46265c4292.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291],"y":[14.886740505695343,14.987024009227753,14.952440857887268,9.4708342552185059,7.2951310873031616,5.6335764527320862,5.4782339036464691,5.4553603827953339,21.392239451408386,15.917689919471741,14.984151363372803,11.586887776851654,9.4009062945842743,5.718112975358963,5.4852002263069153,5.4547101259231567,27.616916298866272,15.139654755592346,14.415108382701874,14.808838605880737,5.1746111959218979,5.4831224083900452,5.4634588658809662,5.4506508708000183,12.496735453605652,19.283251762390137,15.339589655399323,14.844583332538605,5.3392128646373749,5.5308659076690674,5.5243070125579834,20.682004988193512,16.17027622461319,15.027545213699341,12.859277129173279,5.2104063034057617,5.5289207696914673,5.4638950824737549,5.4196419417858124,28.001768231391907,15.188151776790619,14.501740872859955,6.2074384689331055,5.5708670318126678,5.4718502461910248,5.4514394402503967,27.851559519767761,15.12455803155899,14.466356635093689,7.704458087682724,5.6535666882991791,5.4789336025714874,5.4492126703262329,27.929595351219177,6.3910581171512604,19.581031858921051,5.7447027862071991,5.4620344340801239,25.391155242919922,10.422561854124069,17.137558043003082,5.4608597159385681,5.4453937411308289,5.444757878780365,5.4813174605369568,28.040723562240601,8.9754142463207245,12.590119600296021,15.488584220409393,5.8906888961791992,5.471586138010025,5.4469909071922302,27.141766905784607,130.95992660522461,20.316734611988068,5.0627391636371613,4.909075140953064,5.5614229738712311,5.3593282699584961,27.879720211029053,15.134923338890076,128.56511878967285,19.248144149780273,67.523705005645752,3.7930519133806229,4.9394309967756271,5.3044619858264923,5.3469245731830597,28.006459593772888,6.3736063241958618,19.636021435260773,5.9221240282058716,5.4559286534786224,17.443141222000122,4.998876616358757,23.754473090171814,15.189011693000793,14.653978586196899,5.2650817036628723,5.5198622345924377,5.4724141359329224,5.4480041563510895,28.280779123306274,6.6454055607318878,19.395000815391541,5.4122556746006012,5.4708645343780518,5.4430042505264282,16.245341777801514,17.079591929912567,7.1026926040649414,19.520884037017822,6.613968551158905,5.6254360377788544,5.4724272787570953,5.4455796182155609,5.4725461900234222,10.242594033479691,21.16910183429718,6.9235534071922302,11.470695197582245,71.752364873886108,10.684045851230621,38.712929606437683,5.0528579503297806,5.2985020279884338,5.3962558507919312,5.4429892301559448,27.855990529060364,6.5192500948905945,19.686294615268707,5.6577736437320709,5.5616939663887024,5.9434266686439514,5.4274350106716156,27.899757385253906,8.0442989766597748,18.277117252349854,9.5820938944816589,7.4320079684257507,5.6430999934673309,5.4821266829967499,17.623444497585297,10.638804495334625,17.199252963066101,7.6706178188323975,16.56850129365921,5.8805007040500641,5.4736933708190918,5.4679512083530426,13.173649728298187,18.314578056335449,14.373153984546661,9.4457270801067352,5.6988330781459808,5.4851507842540741,48.566715717315674,9.1621875464916229,14.280499577522278,13.270422220230103,5.0401328802108765,5.5086426436901093,5.4784773588180542,27.705238580703735,6.82976433634758,19.346476256847382,6.9115978181362152,5.6388241946697235,5.4758713245391846,5.4616451561450958,27.889415860176086,109.75688123703003,20.307190418243408,5.4213899374008179,4.9901632368564606,5.2876867353916168,5.4408682286739349,27.955477952957153,15.115797400474548,7.182361900806427,16.235583543777466,6.087315559387207,5.4713201522827148,5.490175724029541,27.389117360115051,12.15547513961792,13.471727728843689,15.953455924987793,5.0782702267169952,5.5076638162136078,5.4611075520515442,5.5245892703533173,28.157947540283203,6.4733666181564331,5.6207590699195862,5.370050311088562,5.3771856129169464,5.4523531794548035,28.16672694683075,15.131287157535553,7.2087307870388031,11.542004406452179,5.7848240733146667,5.4854418039321899,5.4591905772686005,27.837658166885376,7.5215431451797485,17.190632522106171,6.6646604239940643,5.4467236697673798,6.2073445916175842,25.099304437637329,15.178398549556732,9.3038678169250488,17.32857209444046,5.6242844760417938,5.5456465780735016,5.4682929217815399,5.6788722574710846,27.510509490966797,6.8743798434734344,19.236843824386597,15.157000780105591,5.2129391133785248,5.474861204624176,5.4624099433422089,27.553622961044312,15.122373819351196,10.068567395210266,12.112349152565002,5.7909392416477203,5.4791301190853119,5.4506026804447174,24.803340554237366,11.788051843643188,16.304893791675568,8.6482862234115601,5.2855056524276733,5.491377979516983,5.4700265228748322,27.95307469367981,6.5491318702697754,19.571312427520752,4.9344069957733154,5.4997530877590179,5.4439367651939392,5.4483258426189423,19.367124259471893,16.324280083179474,15.131268382072449,8.6949225962162018,17.932412266731262,5.6891524493694305,5.4704189300537109,25.700241923332214,13.934460282325745,14.95602822303772,5.5623148083686829,5.5458143055438995,5.4636754095554352,5.4525259137153625,26.643118143081665,15.244230329990387,14.667187750339508,13.196455657482147,7.0894308686256409,5.631520539522171,5.4786069095134735,5.5488340258598328,17.198889970779419,17.295634925365448,15.230151236057281,8.8420928120613098,7.94098761677742,5.6584689617156982,5.4845124185085297,5.4358777105808258,26.435992240905762,10.288302272558212,5.0739794075489044,5.495444118976593,5.4566771686077118,5.5307457447052002,27.883360147476196,15.121472597122192,7.754039078950882,11.777920603752136,5.8028610348701477,5.486741691827774,9.181290328502655,21.061571002006531],"mode":"lines","line":{"color":"red"},"name":"Predicciones","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Ajuste de las predicciones modelo ELMAN en datos de entrenamiento","xaxis":{"domain":[0,1],"automargin":true,"title":"Observación"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ausentismo normalizado"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291],"y":[0,0,27.000000000000004,8,3,14,2,0,0,14,18,2,8,3,0,0,2,10,15,5,28,0,0,14,22,16,20,9,0,0,18,11,7,13,24,0,0,13,5,14,24,5,0,0,2,13,31,13,9,0,0,47,8,40,0,12,0,0,67,46.000000000000007,21,8,8,0,0,22,15,36,35,53,0,0,126,152,31,11,5,0,0,12,17,145,8,77,0,0,24,3,5,2,34,0,0,12,7,18,25,2,0,0,5,4,66,1,7,0,0,8,0,20,2,99,0,0,2,8,13,10,0,0,0,85,10,43,1,3,0,0,8,3,19,0,10,0,0,23.000000000000004,1,27.000000000000004,13,18,0,0,16,1,80,15,26,0,0,8,16,8,14,2,0,0,52,27.000000000000004,8,4,6,0,0,44,3,31,32,0,0,0,65,120,20,8,23.000000000000004,0,0,40,24,2,22,16,0,0,12,6,19,6,4,0,0,16,150,12,11,30,0,0,103,25,13,13,7,0,0,6,14,8,23.000000000000004,0,0,0,50.999999999999993,17,10,20,4,0,0,20,12,0,3,8,0,0,9,29,0,7,14,0,0,55,3,11,5,24,0,0,6,12,27.000000000000004,0,9,0,0,24,6,3,3,3,0,0,32,26,40,0,3,0,0,10,11,4,37,23.000000000000004,0,0,23.000000000000004,9,2,23.000000000000004,7,0,0,16,12,74,11,3,0,0,10,21,24,0,8,0,0,16,1],"mode":"lines","line":{"color":"black"},"name":"Datos reales","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291],"y":[14.886740505695343,14.987024009227753,14.952440857887268,9.4708342552185059,7.2951310873031616,5.6335764527320862,5.4782339036464691,5.4553603827953339,21.392239451408386,15.917689919471741,14.984151363372803,11.586887776851654,9.4009062945842743,5.718112975358963,5.4852002263069153,5.4547101259231567,27.616916298866272,15.139654755592346,14.415108382701874,14.808838605880737,5.1746111959218979,5.4831224083900452,5.4634588658809662,5.4506508708000183,12.496735453605652,19.283251762390137,15.339589655399323,14.844583332538605,5.3392128646373749,5.5308659076690674,5.5243070125579834,20.682004988193512,16.17027622461319,15.027545213699341,12.859277129173279,5.2104063034057617,5.5289207696914673,5.4638950824737549,5.4196419417858124,28.001768231391907,15.188151776790619,14.501740872859955,6.2074384689331055,5.5708670318126678,5.4718502461910248,5.4514394402503967,27.851559519767761,15.12455803155899,14.466356635093689,7.704458087682724,5.6535666882991791,5.4789336025714874,5.4492126703262329,27.929595351219177,6.3910581171512604,19.581031858921051,5.7447027862071991,5.4620344340801239,25.391155242919922,10.422561854124069,17.137558043003082,5.4608597159385681,5.4453937411308289,5.444757878780365,5.4813174605369568,28.040723562240601,8.9754142463207245,12.590119600296021,15.488584220409393,5.8906888961791992,5.471586138010025,5.4469909071922302,27.141766905784607,130.95992660522461,20.316734611988068,5.0627391636371613,4.909075140953064,5.5614229738712311,5.3593282699584961,27.879720211029053,15.134923338890076,128.56511878967285,19.248144149780273,67.523705005645752,3.7930519133806229,4.9394309967756271,5.3044619858264923,5.3469245731830597,28.006459593772888,6.3736063241958618,19.636021435260773,5.9221240282058716,5.4559286534786224,17.443141222000122,4.998876616358757,23.754473090171814,15.189011693000793,14.653978586196899,5.2650817036628723,5.5198622345924377,5.4724141359329224,5.4480041563510895,28.280779123306274,6.6454055607318878,19.395000815391541,5.4122556746006012,5.4708645343780518,5.4430042505264282,16.245341777801514,17.079591929912567,7.1026926040649414,19.520884037017822,6.613968551158905,5.6254360377788544,5.4724272787570953,5.4455796182155609,5.4725461900234222,10.242594033479691,21.16910183429718,6.9235534071922302,11.470695197582245,71.752364873886108,10.684045851230621,38.712929606437683,5.0528579503297806,5.2985020279884338,5.3962558507919312,5.4429892301559448,27.855990529060364,6.5192500948905945,19.686294615268707,5.6577736437320709,5.5616939663887024,5.9434266686439514,5.4274350106716156,27.899757385253906,8.0442989766597748,18.277117252349854,9.5820938944816589,7.4320079684257507,5.6430999934673309,5.4821266829967499,17.623444497585297,10.638804495334625,17.199252963066101,7.6706178188323975,16.56850129365921,5.8805007040500641,5.4736933708190918,5.4679512083530426,13.173649728298187,18.314578056335449,14.373153984546661,9.4457270801067352,5.6988330781459808,5.4851507842540741,48.566715717315674,9.1621875464916229,14.280499577522278,13.270422220230103,5.0401328802108765,5.5086426436901093,5.4784773588180542,27.705238580703735,6.82976433634758,19.346476256847382,6.9115978181362152,5.6388241946697235,5.4758713245391846,5.4616451561450958,27.889415860176086,109.75688123703003,20.307190418243408,5.4213899374008179,4.9901632368564606,5.2876867353916168,5.4408682286739349,27.955477952957153,15.115797400474548,7.182361900806427,16.235583543777466,6.087315559387207,5.4713201522827148,5.490175724029541,27.389117360115051,12.15547513961792,13.471727728843689,15.953455924987793,5.0782702267169952,5.5076638162136078,5.4611075520515442,5.5245892703533173,28.157947540283203,6.4733666181564331,5.6207590699195862,5.370050311088562,5.3771856129169464,5.4523531794548035,28.16672694683075,15.131287157535553,7.2087307870388031,11.542004406452179,5.7848240733146667,5.4854418039321899,5.4591905772686005,27.837658166885376,7.5215431451797485,17.190632522106171,6.6646604239940643,5.4467236697673798,6.2073445916175842,25.099304437637329,15.178398549556732,9.3038678169250488,17.32857209444046,5.6242844760417938,5.5456465780735016,5.4682929217815399,5.6788722574710846,27.510509490966797,6.8743798434734344,19.236843824386597,15.157000780105591,5.2129391133785248,5.474861204624176,5.4624099433422089,27.553622961044312,15.122373819351196,10.068567395210266,12.112349152565002,5.7909392416477203,5.4791301190853119,5.4506026804447174,24.803340554237366,11.788051843643188,16.304893791675568,8.6482862234115601,5.2855056524276733,5.491377979516983,5.4700265228748322,27.95307469367981,6.5491318702697754,19.571312427520752,4.9344069957733154,5.4997530877590179,5.4439367651939392,5.4483258426189423,19.367124259471893,16.324280083179474,15.131268382072449,8.6949225962162018,17.932412266731262,5.6891524493694305,5.4704189300537109,25.700241923332214,13.934460282325745,14.95602822303772,5.5623148083686829,5.5458143055438995,5.4636754095554352,5.4525259137153625,26.643118143081665,15.244230329990387,14.667187750339508,13.196455657482147,7.0894308686256409,5.631520539522171,5.4786069095134735,5.5488340258598328,17.198889970779419,17.295634925365448,15.230151236057281,8.8420928120613098,7.94098761677742,5.6584689617156982,5.4845124185085297,5.4358777105808258,26.435992240905762,10.288302272558212,5.0739794075489044,5.495444118976593,5.4566771686077118,5.5307457447052002,27.883360147476196,15.121472597122192,7.754039078950882,11.777920603752136,5.8028610348701477,5.486741691827774,9.181290328502655,21.061571002006531],"mode":"lines","line":{"color":"red"},"name":"Predicciones","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>En este caso se evidencia el comportamiento de las 291 observaciones que hacen parte del dataset de entrenaiento y se observan ciertas diferencias. Aunque las predicciones tratan de ajustarse a los datos reales, no los siguen completamente bien, sobre todo se evidencia que no hay ausencias de 0 horas en la predicción.</p>
</div>
<div id="desempeño-del-modelo-elman-con-datos-de-prueba." class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Desempeño del modelo ELMAN con datos de prueba.<a href="redes-neuronales.html#desempeño-del-modelo-elman-con-datos-de-prueba." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Este conjunto de bloques de código evalúa el desempeño del modelo de red neuronal ELMAN sobre el conjunto de prueba. Primero, se extraen las salidas verdaderas (y_test) y se calculan las predicciones del modelo (predtest1) usando únicamente las observaciones que no formaron parte del conjunto de entrenamiento. Luego, ambas series —que previamente fueron normalizadas— se transforman nuevamente a su escala original mediante una operación de desnormalización basada en el rango de los datos originales (ts_diaria).</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="redes-neuronales.html#cb90-1" tabindex="-1"></a><span class="co"># se elimina el conjunto de test de las entradas y salidas de las neuronas para realizar el ajuste del modelo a los datos reales</span></span>
<span id="cb90-2"><a href="redes-neuronales.html#cb90-2" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>train])</span>
<span id="cb90-3"><a href="redes-neuronales.html#cb90-3" tabindex="-1"></a>predtest1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, inputs[<span class="sc">-</span>train])</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="redes-neuronales.html#cb91-1" tabindex="-1"></a>y_test<span class="ot">&lt;-</span>y_test<span class="sc">*</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">+</span><span class="fu">min</span>(ts_diaria)</span>
<span id="cb91-2"><a href="redes-neuronales.html#cb91-2" tabindex="-1"></a>predtest1<span class="ot">&lt;-</span>predtest1<span class="sc">*</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">+</span><span class="fu">min</span>(ts_diaria)</span></code></pre></div>
<p>Finalmente, se genera un gráfico interactivo en el que se superponen los valores reales (línea negra) y las predicciones (línea roja) para cada observación del conjunto de prueba (62 Observaciones). Este gráfico permite evaluar visualmente qué tan bien el modelo ELMAN generaliza a datos nuevos, y si sus predicciones son razonablemente cercanas a los valores reales.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="redes-neuronales.html#cb92-1" tabindex="-1"></a>pt2 <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y_test), <span class="at">y =</span> y_test, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>,</span>
<span id="cb92-2"><a href="redes-neuronales.html#cb92-2" tabindex="-1"></a>             <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>), <span class="at">name =</span> <span class="st">&#39;Datos reales&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="redes-neuronales.html#cb92-3" tabindex="-1"></a>     plotly<span class="sc">::</span><span class="fu">add_lines</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(predtest1), <span class="at">y =</span> predtest1, </span>
<span id="cb92-4"><a href="redes-neuronales.html#cb92-4" tabindex="-1"></a>               <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;red&#39;</span>), <span class="at">name =</span> <span class="st">&#39;Predicciones&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-5"><a href="redes-neuronales.html#cb92-5" tabindex="-1"></a>     plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&quot;Ajuste de las predicciones modelo ELMAN en datos de prueba&quot;</span>,</span>
<span id="cb92-6"><a href="redes-neuronales.html#cb92-6" tabindex="-1"></a>            <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Observación&quot;</span>),</span>
<span id="cb92-7"><a href="redes-neuronales.html#cb92-7" tabindex="-1"></a>            <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Ausentismo&quot;</span>))</span>
<span id="cb92-8"><a href="redes-neuronales.html#cb92-8" tabindex="-1"></a></span>
<span id="cb92-9"><a href="redes-neuronales.html#cb92-9" tabindex="-1"></a>pt2</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-c716681bc0cf78cd5964" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-c716681bc0cf78cd5964">{"x":{"visdat":{"11f46456d24b8":["function () ","plotlyVisDat"]},"cur_data":"11f46456d24b8","attrs":{"11f46456d24b8":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"y":[4,9,8,0,0,4,3,38,3,12,0,0,168,3,24,15,24,0,0,27.000000000000004,17,11,8,9,0,0,48,16,13,5,8,0,0,0,2,16,3,9,0,0,2,159,9,3,23.000000000000004,0,0,19,112,8,0,4,0,0,0,2,8,17,7,0,0,11],"mode":"lines","line":{"color":"black"},"name":"Datos reales","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"11f46456d24b8.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"y":[[15.182131111621857],[8.8699080348014832],[17.49767017364502],[5.7080261707305908],[5.4707562625408173],[5.4842301607131958],[6.5477650165557861],[25.919834733009338],[14.961548209190369],[7.6964509785175323],[5.3593683242797852],[5.4883401095867157],[5.455007404088974],[86.026558399200439],[37.952553391456604],[3.8919904679059982],[4.9230935275554657],[5.308053731918335],[19.275899291038513],[16.183113634586334],[26.07687771320343],[14.807777166366577],[77.417983531951904],[4.0025513470172882],[15.17113995552063],[14.920511305332184],[14.998285531997681],[7.4390243589878082],[18.723823070526123],[5.8718564808368683],[5.4627835750579834],[5.4403894543647766],[5.6295922994613647],[27.727856755256653],[14.620311677455902],[14.538902521133423],[13.56472635269165],[5.6867022514343262],[5.4678898751735687],[5.4445957839488983],[5.5174164175987244],[28.104712843894958],[6.8209235966205597],[5.7103587090969086],[5.3258497416973114],[5.3966125845909119],[5.4301342964172363],[27.300414562225342],[15.192480146884918],[6.2291410267353058],[17.677791953086853],[21.87007999420166],[5.2998964190483093],[5.3701748549938202],[25.202717185020447],[15.160715818405151],[7.0130347609519958],[15.674749195575714],[6.1530215442180634],[5.4754288494586945],[16.272368431091309],[16.664067149162292]],"mode":"lines","line":{"color":"red"},"name":"Predicciones","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Ajuste de las predicciones modelo ELMAN en datos de prueba","xaxis":{"domain":[0,1],"automargin":true,"title":"Observación"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ausentismo"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"y":[4,9,8,0,0,4,3,38,3,12,0,0,168,3,24,15,24,0,0,27.000000000000004,17,11,8,9,0,0,48,16,13,5,8,0,0,0,2,16,3,9,0,0,2,159,9,3,23.000000000000004,0,0,19,112,8,0,4,0,0,0,2,8,17,7,0,0,11],"mode":"lines","line":{"color":"black"},"name":"Datos reales","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"y":[15.182131111621857,8.8699080348014832,17.49767017364502,5.7080261707305908,5.4707562625408173,5.4842301607131958,6.5477650165557861,25.919834733009338,14.961548209190369,7.6964509785175323,5.3593683242797852,5.4883401095867157,5.455007404088974,86.026558399200439,37.952553391456604,3.8919904679059982,4.9230935275554657,5.308053731918335,19.275899291038513,16.183113634586334,26.07687771320343,14.807777166366577,77.417983531951904,4.0025513470172882,15.17113995552063,14.920511305332184,14.998285531997681,7.4390243589878082,18.723823070526123,5.8718564808368683,5.4627835750579834,5.4403894543647766,5.6295922994613647,27.727856755256653,14.620311677455902,14.538902521133423,13.56472635269165,5.6867022514343262,5.4678898751735687,5.4445957839488983,5.5174164175987244,28.104712843894958,6.8209235966205597,5.7103587090969086,5.3258497416973114,5.3966125845909119,5.4301342964172363,27.300414562225342,15.192480146884918,6.2291410267353058,17.677791953086853,21.87007999420166,5.2998964190483093,5.3701748549938202,25.202717185020447,15.160715818405151,7.0130347609519958,15.674749195575714,6.1530215442180634,5.4754288494586945,16.272368431091309,16.664067149162292],"mode":"lines","line":{"color":"red"},"name":"Predicciones","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Mientras que el gráfico basado en y_train y predtrain1 busca evaluar qué tan bien el modelo de red neuronal ELMAN fue capaz de aprender los patrones presentes en el conjunto de entrenamiento, el gráfico basado en y_test y predtest1 tiene un objetivo mucho más crítico: medir la capacidad de generalización del modelo a datos nunca antes vistos.</p>
<p>Esto es importante porque un modelo que memoriza los datos de entrenamiento sin poder predecir con precisión sobre datos nuevos probablemente esté sobreajustado. En cambio, si las predicciones sobre el conjunto de prueba son buenas, podemos confiar en que el modelo será útil en contextos reales o futuros.</p>
<p>Ambos gráficos se desnormalizan para facilitar la interpretación, pero su utilidad analítica es diferente: el primero es introspectivo (¿aprendió el modelo?), y el segundo es prospectivo (¿puede predecir bien?). En este caso, se ve que el modelo tuvo problemas con los datos atípicos y prediciendo los días de 0 horas de ausentismo. Lo mejor sería ajustar los hiperparámetros del modelo para tratar de obtener un mayor ajuste respecto a las métricas de rendimiento.</p>
</div>
</div>
<div id="redes-neuronales-jordan" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Redes neuronales: JORDAN<a href="redes-neuronales.html#redes-neuronales-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La red Jordan es un tipo de red neuronal recurrente, donde parte de la salida del modelo se retroalimenta a sí misma en el siguiente paso temporal. Es útil para series temporales o datos secuenciales, ya que puede recordar patrones del pasado inmediato.</p>
<p>Se solicitan 10 capas ocultas y un factor de tasa de aprendizaje de 1. El resultado también se parcialmente a la serie original</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="redes-neuronales.html#cb93-1" tabindex="-1"></a>fit2<span class="ot">&lt;-</span><span class="fu">jordan</span>(inputs[train],</span>
<span id="cb93-2"><a href="redes-neuronales.html#cb93-2" tabindex="-1"></a> outputs[train],</span>
<span id="cb93-3"><a href="redes-neuronales.html#cb93-3" tabindex="-1"></a> <span class="at">size=</span><span class="dv">10</span>,</span>
<span id="cb93-4"><a href="redes-neuronales.html#cb93-4" tabindex="-1"></a> <span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb93-5"><a href="redes-neuronales.html#cb93-5" tabindex="-1"></a> <span class="at">maxit=</span><span class="dv">10000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="redes-neuronales.html#cb94-1" tabindex="-1"></a><span class="fu">plotIterativeError</span>(fit2, <span class="at">main =</span> <span class="st">&quot;Error iterativo para 5 neuronas&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-59-1.png" width="672" />
La gráfica anterior muestra que el error en el modelo JORDAN converge a cero, por lo que se espera un ajuste rápido del modelo. Esto indica que el modelo ha logrado aprender una representación correcta de los datos.</p>
<div id="desempeño-del-modelo-jordan-con-datos-de-entrenamiento." class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Desempeño del modelo JORDAN con datos de entrenamiento.<a href="redes-neuronales.html#desempeño-del-modelo-jordan-con-datos-de-entrenamiento." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para identificar el desempeño del modelo JORDAN con datos de entrenamiento primero se elimina el conjunto de test de las neuronas con el objetivo de realizar el modelo con datos reales, después para interpretarlas correctamente (en horas reales de ausentismo) debemos desnormalizar, esto es invertir el escalamiento que hicimos al inicio por tanto las predicciones están en el mismo rango real.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="redes-neuronales.html#cb95-1" tabindex="-1"></a><span class="co"># Se elimina el conjunto de test de las entradas y salidas de las neuronas para realizar el ajuste del modelo a los datos reales</span></span>
<span id="cb95-2"><a href="redes-neuronales.html#cb95-2" tabindex="-1"></a>y_j_train <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>test])</span>
<span id="cb95-3"><a href="redes-neuronales.html#cb95-3" tabindex="-1"></a>predtrain2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, inputs[<span class="sc">-</span>test])</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="redes-neuronales.html#cb96-1" tabindex="-1"></a>y_j_train<span class="ot">&lt;-</span>y_j_train<span class="sc">*</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">+</span><span class="fu">min</span>(ts_diaria)</span>
<span id="cb96-2"><a href="redes-neuronales.html#cb96-2" tabindex="-1"></a>predtrain2<span class="ot">&lt;-</span>predtrain2<span class="sc">*</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">+</span><span class="fu">min</span>(ts_diaria)</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="redes-neuronales.html#cb97-1" tabindex="-1"></a>pt3 <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y_j_train), <span class="at">y =</span> y_j_train, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>,</span>
<span id="cb97-2"><a href="redes-neuronales.html#cb97-2" tabindex="-1"></a>             <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>), <span class="at">name =</span> <span class="st">&#39;Datos reales&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="redes-neuronales.html#cb97-3" tabindex="-1"></a>     plotly<span class="sc">::</span><span class="fu">add_lines</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(predtrain2), <span class="at">y =</span> predtrain2, </span>
<span id="cb97-4"><a href="redes-neuronales.html#cb97-4" tabindex="-1"></a>               <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;red&#39;</span>), <span class="at">name =</span> <span class="st">&#39;Predicciones&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-5"><a href="redes-neuronales.html#cb97-5" tabindex="-1"></a>     plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&quot;Ajuste de las predicciones modelo JORDAN en datos de entrenamiento&quot;</span>,</span>
<span id="cb97-6"><a href="redes-neuronales.html#cb97-6" tabindex="-1"></a>            <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Observación&quot;</span>),</span>
<span id="cb97-7"><a href="redes-neuronales.html#cb97-7" tabindex="-1"></a>            <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Ausentismo normalizado&quot;</span>))</span>
<span id="cb97-8"><a href="redes-neuronales.html#cb97-8" tabindex="-1"></a></span>
<span id="cb97-9"><a href="redes-neuronales.html#cb97-9" tabindex="-1"></a>pt3</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-3a56c697349676434372" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3a56c697349676434372">{"x":{"visdat":{"11f4610b16d5":["function () ","plotlyVisDat"]},"cur_data":"11f4610b16d5","attrs":{"11f4610b16d5":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291],"y":[0,0,27.000000000000004,8,3,14,2,0,0,14,18,2,8,3,0,0,2,10,15,5,28,0,0,14,22,16,20,9,0,0,18,11,7,13,24,0,0,13,5,14,24,5,0,0,2,13,31,13,9,0,0,47,8,40,0,12,0,0,67,46.000000000000007,21,8,8,0,0,22,15,36,35,53,0,0,126,152,31,11,5,0,0,12,17,145,8,77,0,0,24,3,5,2,34,0,0,12,7,18,25,2,0,0,5,4,66,1,7,0,0,8,0,20,2,99,0,0,2,8,13,10,0,0,0,85,10,43,1,3,0,0,8,3,19,0,10,0,0,23.000000000000004,1,27.000000000000004,13,18,0,0,16,1,80,15,26,0,0,8,16,8,14,2,0,0,52,27.000000000000004,8,4,6,0,0,44,3,31,32,0,0,0,65,120,20,8,23.000000000000004,0,0,40,24,2,22,16,0,0,12,6,19,6,4,0,0,16,150,12,11,30,0,0,103,25,13,13,7,0,0,6,14,8,23.000000000000004,0,0,0,50.999999999999993,17,10,20,4,0,0,20,12,0,3,8,0,0,9,29,0,7,14,0,0,55,3,11,5,24,0,0,6,12,27.000000000000004,0,9,0,0,24,6,3,3,3,0,0,32,26,40,0,3,0,0,10,11,4,37,23.000000000000004,0,0,23.000000000000004,9,2,23.000000000000004,7,0,0,16,12,74,11,3,0,0,10,21,24,0,8,0,0,16,1],"mode":"lines","line":{"color":"black"},"name":"Datos reales","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"11f4610b16d5.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291],"y":[[-1.5980985760688782],[11.756844520568848],[19.062501132488251],[13.697963297367096],[28.172394633293152],[6.077857106924057],[6.3819463849067688],[4.9388642907142639],[4.544137716293335],[19.146831750869751],[13.421279311180115],[24.242469906806946],[5.0769127607345581],[8.1662468612194061],[1.3131258487701416],[7.3869956731796265],[14.872129440307617],[17.284852802753448],[9.7872996926307678],[25.042752742767334],[-2.165571928024292],[6.1839766502380371],[10.963736414909363],[19.127485513687134],[16.610714793205261],[10.626201152801514],[6.5471604466438293],[10.471829921007156],[5.7730931639671326],[0.19570228457450867],[14.288429081439972],[13.743623971939087],[22.029538750648499],[6.9112442135810852],[6.407555490732193],[8.1398254036903381],[6.8926427364349365],[22.282484292984009],[15.822997748851776],[10.674031019210815],[7.3448259830474854],[9.198094367980957],[5.5745676755905151],[-2.2164772152900696],[14.236019253730774],[11.315755069255829],[32.425029516220093],[8.6924805343151093],[6.2492902278900146],[3.2990488260984421],[4.1817562580108643],[16.530208110809326],[37.087983369827271],[7.9873035550117493],[12.840312659740448],[11.310651898384094],[4.9890392124652863],[-2.6241062879562378],[29.714000344276428],[43.158060550689697],[23.238671064376831],[9.2716854214668274],[11.20504367351532],[-8.5086925327777863],[8.5059281587600708],[26.865980386734009],[9.2493357360363007],[10.750413358211517],[10.947097599506378],[39.390170574188232],[2.326085239648819],[-1.2714377492666245],[109.16084289550781],[136.20207595825195],[32.740284562110901],[10.480363994836807],[6.3995465040206909],[-8.3704857230186462],[-24.36809778213501],[16.716985166072845],[9.2477629780769348],[131.5112943649292],[16.602503657341003],[76.137356758117676],[-13.22223436832428],[-20.318981409072876],[-84.688263416290283],[642.14126586914062],[-94.507630348205566],[25.901549935340881],[17.659294366836548],[0.99877296388149261],[-3.5776119232177734],[9.5482066869735718],[10.964968085289001],[17.409274041652679],[4.4130198955535889],[10.282902449369431],[6.6661668419837952],[-10.731992125511169],[22.90718150138855],[-0.62394618988037109],[48.272777080535889],[9.3385798931121826],[7.8731099367141724],[2.6966825276613235],[3.1186569929122925],[-11.91632080078125],[35.503875017166138],[9.727986752986908],[8.6624103784561157],[61.35508918762207],[8.4628046751022339],[-13.900041103363037],[-60.636860132217407],[205.0488452911377],[20.296827614307404],[-12.019952595233917],[10.807799935340881],[4.5017374008893967],[-2.2056850790977478],[79.269834995269775],[7.1000690460205078],[53.051823377609253],[-11.161992788314819],[-8.9565079808235168],[-41.056009769439697],[245.25004577636719],[-3.8572539836168289],[21.41320788860321],[18.333864212036133],[1.7044521868228912],[-0.48174333572387695],[-17.612196743488312],[16.190191984176636],[-4.443556934595108],[41.272047758102417],[5.5919162034988403],[12.081019163131714],[15.30651730298996],[5.7053074836730957],[2.0149526596069336],[18.529076457023621],[12.580282509326935],[20.628300905227661],[12.613791704177856],[30.255937814712524],[7.3714984059333801],[1.3369400203227997],[4.2704928517341614],[13.698438942432404],[15.242037355899811],[6.8341659307479858],[13.95958936214447],[6.6853891611099243],[-5.7946186065673828],[47.916118383407593],[13.334624290466309],[23.97703492641449],[4.4879452586174011],[5.6104920208454132],[-10.525644779205322],[5.875298023223877],[19.852348566055298],[15.625630080699921],[20.062904119491577],[12.09169614315033],[13.565526187419891],[-8.035146564245224],[-4.6679675281047821],[33.835169434547424],[99.992138385772705],[23.63644802570343],[3.5647951662540436],[16.33540016412735],[-20.765344262123108],[-4.1864526271820068],[51.743644237518311],[20.607291162014008],[7.2419840097427368],[16.259181797504425],[21.430936932563782],[6.5269405245780945],[-1.0740406662225723],[18.645982503890991],[10.848674118518829],[8.8403911292552948],[13.046479761600494],[-0.060741126537322998],[-8.542144775390625],[9.3564015626907349],[4.4087315797805786],[29.066184282302856],[34.21520733833313],[18.707816362380981],[6.8590083718299866],[8.327391654253006],[-11.269021689891815],[157.3772234916687],[19.12026447057724],[11.793271422386169],[12.926489531993866],[9.3728851675987244],[-2.7104893773794174],[-33.739862680435181],[15.929159224033356],[10.380143076181412],[11.529616355895996],[15.085286021232605],[5.1156578063964844],[-10.990122199058533],[-3.2523276507854462],[32.713280439376831],[20.412428140640259],[13.470618724822998],[6.803272157907486],[8.1749711930751801],[-1.1884298622608185],[9.4086686968803406],[21.359142065048218],[17.164945185184479],[14.867526948451996],[6.9793140292167664],[3.3247502446174622],[4.3300711512565613],[20.877994537353516],[8.3965573310852051],[16.656433045864105],[18.293091416358948],[5.6865094900131226],[14.182101130485535],[4.0566184222698212],[4.1814934015274048],[15.698342442512512],[17.438548743724823],[12.326140344142914],[11.963454723358154],[4.7667126953601837],[-0.23501935601234436],[1.8979940414428711],[17.379294633865356],[9.2891190648078918],[27.299628496170044],[2.8007583618164062],[7.2269736528396606],[-11.337160348892212],[12.195361733436584],[7.6529613733291626],[20.02185720205307],[18.614557385444641],[3.4063205569982529],[8.7631532549858093],[2.0352777242660522],[6.4536924362182617],[32.681339621543884],[9.0854935348033905],[34.729477286338806],[5.0220840275287628],[-7.4278955161571503],[-15.365074217319489],[9.2488269209861755],[20.223826110363007],[12.4904944896698],[11.880562305450439],[1.6772333979606628],[30.708729386329651],[6.8503140807151794],[3.0008769482374191],[16.050910592079163],[16.500285029411316],[2.7150996923446655],[11.050079762935638],[10.053607106208801],[7.4970805943012238],[0.92446249723434448],[10.445422232151031],[15.276965975761414],[30.495808124542236],[11.324172735214233],[6.055837869644165],[-4.2288401126861572],[-13.751000225543976],[24.635775804519653],[10.647825479507446],[13.406467974185944],[6.6249378025531769],[22.935570001602173],[6.3704921007156372],[-13.382739543914795],[28.318743109703064],[18.160669326782227]],"mode":"lines","line":{"color":"red"},"name":"Predicciones","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Ajuste de las predicciones modelo JORDAN en datos de entrenamiento","xaxis":{"domain":[0,1],"automargin":true,"title":"Observación"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ausentismo normalizado"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291],"y":[0,0,27.000000000000004,8,3,14,2,0,0,14,18,2,8,3,0,0,2,10,15,5,28,0,0,14,22,16,20,9,0,0,18,11,7,13,24,0,0,13,5,14,24,5,0,0,2,13,31,13,9,0,0,47,8,40,0,12,0,0,67,46.000000000000007,21,8,8,0,0,22,15,36,35,53,0,0,126,152,31,11,5,0,0,12,17,145,8,77,0,0,24,3,5,2,34,0,0,12,7,18,25,2,0,0,5,4,66,1,7,0,0,8,0,20,2,99,0,0,2,8,13,10,0,0,0,85,10,43,1,3,0,0,8,3,19,0,10,0,0,23.000000000000004,1,27.000000000000004,13,18,0,0,16,1,80,15,26,0,0,8,16,8,14,2,0,0,52,27.000000000000004,8,4,6,0,0,44,3,31,32,0,0,0,65,120,20,8,23.000000000000004,0,0,40,24,2,22,16,0,0,12,6,19,6,4,0,0,16,150,12,11,30,0,0,103,25,13,13,7,0,0,6,14,8,23.000000000000004,0,0,0,50.999999999999993,17,10,20,4,0,0,20,12,0,3,8,0,0,9,29,0,7,14,0,0,55,3,11,5,24,0,0,6,12,27.000000000000004,0,9,0,0,24,6,3,3,3,0,0,32,26,40,0,3,0,0,10,11,4,37,23.000000000000004,0,0,23.000000000000004,9,2,23.000000000000004,7,0,0,16,12,74,11,3,0,0,10,21,24,0,8,0,0,16,1],"mode":"lines","line":{"color":"black"},"name":"Datos reales","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291],"y":[-1.5980985760688782,11.756844520568848,19.062501132488251,13.697963297367096,28.172394633293152,6.077857106924057,6.3819463849067688,4.9388642907142639,4.544137716293335,19.146831750869751,13.421279311180115,24.242469906806946,5.0769127607345581,8.1662468612194061,1.3131258487701416,7.3869956731796265,14.872129440307617,17.284852802753448,9.7872996926307678,25.042752742767334,-2.165571928024292,6.1839766502380371,10.963736414909363,19.127485513687134,16.610714793205261,10.626201152801514,6.5471604466438293,10.471829921007156,5.7730931639671326,0.19570228457450867,14.288429081439972,13.743623971939087,22.029538750648499,6.9112442135810852,6.407555490732193,8.1398254036903381,6.8926427364349365,22.282484292984009,15.822997748851776,10.674031019210815,7.3448259830474854,9.198094367980957,5.5745676755905151,-2.2164772152900696,14.236019253730774,11.315755069255829,32.425029516220093,8.6924805343151093,6.2492902278900146,3.2990488260984421,4.1817562580108643,16.530208110809326,37.087983369827271,7.9873035550117493,12.840312659740448,11.310651898384094,4.9890392124652863,-2.6241062879562378,29.714000344276428,43.158060550689697,23.238671064376831,9.2716854214668274,11.20504367351532,-8.5086925327777863,8.5059281587600708,26.865980386734009,9.2493357360363007,10.750413358211517,10.947097599506378,39.390170574188232,2.326085239648819,-1.2714377492666245,109.16084289550781,136.20207595825195,32.740284562110901,10.480363994836807,6.3995465040206909,-8.3704857230186462,-24.36809778213501,16.716985166072845,9.2477629780769348,131.5112943649292,16.602503657341003,76.137356758117676,-13.22223436832428,-20.318981409072876,-84.688263416290283,642.14126586914062,-94.507630348205566,25.901549935340881,17.659294366836548,0.99877296388149261,-3.5776119232177734,9.5482066869735718,10.964968085289001,17.409274041652679,4.4130198955535889,10.282902449369431,6.6661668419837952,-10.731992125511169,22.90718150138855,-0.62394618988037109,48.272777080535889,9.3385798931121826,7.8731099367141724,2.6966825276613235,3.1186569929122925,-11.91632080078125,35.503875017166138,9.727986752986908,8.6624103784561157,61.35508918762207,8.4628046751022339,-13.900041103363037,-60.636860132217407,205.0488452911377,20.296827614307404,-12.019952595233917,10.807799935340881,4.5017374008893967,-2.2056850790977478,79.269834995269775,7.1000690460205078,53.051823377609253,-11.161992788314819,-8.9565079808235168,-41.056009769439697,245.25004577636719,-3.8572539836168289,21.41320788860321,18.333864212036133,1.7044521868228912,-0.48174333572387695,-17.612196743488312,16.190191984176636,-4.443556934595108,41.272047758102417,5.5919162034988403,12.081019163131714,15.30651730298996,5.7053074836730957,2.0149526596069336,18.529076457023621,12.580282509326935,20.628300905227661,12.613791704177856,30.255937814712524,7.3714984059333801,1.3369400203227997,4.2704928517341614,13.698438942432404,15.242037355899811,6.8341659307479858,13.95958936214447,6.6853891611099243,-5.7946186065673828,47.916118383407593,13.334624290466309,23.97703492641449,4.4879452586174011,5.6104920208454132,-10.525644779205322,5.875298023223877,19.852348566055298,15.625630080699921,20.062904119491577,12.09169614315033,13.565526187419891,-8.035146564245224,-4.6679675281047821,33.835169434547424,99.992138385772705,23.63644802570343,3.5647951662540436,16.33540016412735,-20.765344262123108,-4.1864526271820068,51.743644237518311,20.607291162014008,7.2419840097427368,16.259181797504425,21.430936932563782,6.5269405245780945,-1.0740406662225723,18.645982503890991,10.848674118518829,8.8403911292552948,13.046479761600494,-0.060741126537322998,-8.542144775390625,9.3564015626907349,4.4087315797805786,29.066184282302856,34.21520733833313,18.707816362380981,6.8590083718299866,8.327391654253006,-11.269021689891815,157.3772234916687,19.12026447057724,11.793271422386169,12.926489531993866,9.3728851675987244,-2.7104893773794174,-33.739862680435181,15.929159224033356,10.380143076181412,11.529616355895996,15.085286021232605,5.1156578063964844,-10.990122199058533,-3.2523276507854462,32.713280439376831,20.412428140640259,13.470618724822998,6.803272157907486,8.1749711930751801,-1.1884298622608185,9.4086686968803406,21.359142065048218,17.164945185184479,14.867526948451996,6.9793140292167664,3.3247502446174622,4.3300711512565613,20.877994537353516,8.3965573310852051,16.656433045864105,18.293091416358948,5.6865094900131226,14.182101130485535,4.0566184222698212,4.1814934015274048,15.698342442512512,17.438548743724823,12.326140344142914,11.963454723358154,4.7667126953601837,-0.23501935601234436,1.8979940414428711,17.379294633865356,9.2891190648078918,27.299628496170044,2.8007583618164062,7.2269736528396606,-11.337160348892212,12.195361733436584,7.6529613733291626,20.02185720205307,18.614557385444641,3.4063205569982529,8.7631532549858093,2.0352777242660522,6.4536924362182617,32.681339621543884,9.0854935348033905,34.729477286338806,5.0220840275287628,-7.4278955161571503,-15.365074217319489,9.2488269209861755,20.223826110363007,12.4904944896698,11.880562305450439,1.6772333979606628,30.708729386329651,6.8503140807151794,3.0008769482374191,16.050910592079163,16.500285029411316,2.7150996923446655,11.050079762935638,10.053607106208801,7.4970805943012238,0.92446249723434448,10.445422232151031,15.276965975761414,30.495808124542236,11.324172735214233,6.055837869644165,-4.2288401126861572,-13.751000225543976,24.635775804519653,10.647825479507446,13.406467974185944,6.6249378025531769,22.935570001602173,6.3704921007156372,-13.382739543914795,28.318743109703064,18.160669326782227],"mode":"lines","line":{"color":"red"},"name":"Predicciones","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>En el grafico se muestra el modelo de red JORDAN junto con los datos de entrenamiento. Teniendo en cuenta que las líneas de puntos rojos serían las predicciones y la línea azul serían los valores reales, y el modelo funciona bien si ambas líneas están muy cerca, vemos que la línea roja (predicciones) sigue en parte la forma de la línea negra (datos reales), especialmente en zonas de baja variación, sin embargo, se observan varios picos exagerados en la línea de predicción, que no están presentes en los datos reales. Entre las observaciones entre 90 a 130 y cerca de 180, la red hace predicciones muy altas o negativas, incluso llegando a más de 600 o menos de -100, mientras que los datos reales se mantienen mucho más bajos. En general, el modelo intenta capturar la forma, pero sufre de inestabilidad o exceso de sensibilidad a ciertos patrones, lo cual puede ser síntoma de sobreajuste o mal entrenamiento.</p>
</div>
<div id="desempeño-del-modelo-jordan-con-datos-de-prueba." class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Desempeño del modelo JORDAN con datos de prueba.<a href="redes-neuronales.html#desempeño-del-modelo-jordan-con-datos-de-prueba." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Análogamente se realiza el mismo procedimiento que se hizo con los datos de entrenamiento, solo cambia los datos. En este momento se pone aprueba el modelo con el objetivo de identificar la precisión sobre los datos nuevos. </p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="redes-neuronales.html#cb98-1" tabindex="-1"></a><span class="co"># se elimina el conjunto de test de las entradas y salidas de las neuronas para realizar el ajuste del modelo a los datos reales</span></span>
<span id="cb98-2"><a href="redes-neuronales.html#cb98-2" tabindex="-1"></a>y_j_test <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>train])</span>
<span id="cb98-3"><a href="redes-neuronales.html#cb98-3" tabindex="-1"></a>predtest2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, inputs[<span class="sc">-</span>train])</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="redes-neuronales.html#cb99-1" tabindex="-1"></a>y_j_test<span class="ot">&lt;-</span>y_j_test<span class="sc">*</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">+</span><span class="fu">min</span>(ts_diaria)</span>
<span id="cb99-2"><a href="redes-neuronales.html#cb99-2" tabindex="-1"></a>predtest2<span class="ot">&lt;-</span>predtest2<span class="sc">*</span>(<span class="fu">max</span>(ts_diaria)<span class="sc">-</span><span class="fu">min</span>(ts_diaria))<span class="sc">+</span><span class="fu">min</span>(ts_diaria)</span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="redes-neuronales.html#cb100-1" tabindex="-1"></a>pt4 <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y_j_test), <span class="at">y =</span> y_j_test, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>,</span>
<span id="cb100-2"><a href="redes-neuronales.html#cb100-2" tabindex="-1"></a>             <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>), <span class="at">name =</span> <span class="st">&#39;Datos reales&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="redes-neuronales.html#cb100-3" tabindex="-1"></a>     plotly<span class="sc">::</span><span class="fu">add_lines</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(predtest2), <span class="at">y =</span> predtest2, </span>
<span id="cb100-4"><a href="redes-neuronales.html#cb100-4" tabindex="-1"></a>               <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;red&#39;</span>), <span class="at">name =</span> <span class="st">&#39;Predicciones&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-5"><a href="redes-neuronales.html#cb100-5" tabindex="-1"></a>     plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&quot;Ajuste de las predicciones modelo JORDAN en datos de prueba&quot;</span>,</span>
<span id="cb100-6"><a href="redes-neuronales.html#cb100-6" tabindex="-1"></a>            <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Observación&quot;</span>),</span>
<span id="cb100-7"><a href="redes-neuronales.html#cb100-7" tabindex="-1"></a>            <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;IPC&quot;</span>))</span>
<span id="cb100-8"><a href="redes-neuronales.html#cb100-8" tabindex="-1"></a></span>
<span id="cb100-9"><a href="redes-neuronales.html#cb100-9" tabindex="-1"></a>pt4</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-81e356247fd2f1ea4844" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-81e356247fd2f1ea4844">{"x":{"visdat":{"11f46783afa62":["function () ","plotlyVisDat"]},"cur_data":"11f46783afa62","attrs":{"11f46783afa62":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"y":[4,9,8,0,0,4,3,38,3,12,0,0,168,3,24,15,24,0,0,27.000000000000004,17,11,8,9,0,0,48,16,13,5,8,0,0,0,2,16,3,9,0,0,2,159,9,3,23.000000000000004,0,0,19,112,8,0,4,0,0,0,2,8,17,7,0,0,11],"mode":"lines","line":{"color":"black"},"name":"Datos reales","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"11f46783afa62.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"y":[[9.7049367427825928],[-1.5890262722969055],[27.096077442169189],[0.11473935842514038],[6.702633798122406],[13.119248449802399],[5.7376751303672791],[32.016280174255371],[8.7301159501075745],[-0.6978989839553833],[-0.23682712018489838],[3.9450940489768982],[2.3102881908416748],[305.09210300445557],[-150.13362979888916],[296.93117523193359],[-149.72804975509644],[-180.8876781463623],[937.60196685791016],[46.639767408370972],[661.08744049072266],[-104.63976144790649],[1.639117643237114],[20.126633048057556],[-67.950849294662476],[68.431496143341064],[7.7380430102348328],[17.664523959159851],[26.645456314086914],[8.9962274730205536],[6.3274049162864685],[-10.88880980014801],[-3.3735213875770569],[23.212377905845642],[9.1512583494186401],[14.34026563167572],[19.7087162733078],[-14.260555028915405],[-8.929220974445343],[22.885416984558105],[-1.2992345094680786],[27.930601716041565],[76.999275684356689],[-41.889394998550415],[117.52799034118652],[-98.328952789306641],[-286.29487037658691],[2010.947868347168],[269.49326419830322],[1249.0721397399902],[226.47568416595459],[-205.89575386047363],[72.033531188964844],[798.11215209960938],[-9.4353974461555481],[-6.8357149064540863],[33.407221555709839],[26.808577537536621],[-1.8408365249633789],[-16.923606634140015],[-278.98271369934082],[1499.6001434326172]],"mode":"lines","line":{"color":"red"},"name":"Predicciones","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Ajuste de las predicciones modelo JORDAN en datos de prueba","xaxis":{"domain":[0,1],"automargin":true,"title":"Observación"},"yaxis":{"domain":[0,1],"automargin":true,"title":"IPC"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"y":[4,9,8,0,0,4,3,38,3,12,0,0,168,3,24,15,24,0,0,27.000000000000004,17,11,8,9,0,0,48,16,13,5,8,0,0,0,2,16,3,9,0,0,2,159,9,3,23.000000000000004,0,0,19,112,8,0,4,0,0,0,2,8,17,7,0,0,11],"mode":"lines","line":{"color":"black"},"name":"Datos reales","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],"y":[9.7049367427825928,-1.5890262722969055,27.096077442169189,0.11473935842514038,6.702633798122406,13.119248449802399,5.7376751303672791,32.016280174255371,8.7301159501075745,-0.6978989839553833,-0.23682712018489838,3.9450940489768982,2.3102881908416748,305.09210300445557,-150.13362979888916,296.93117523193359,-149.72804975509644,-180.8876781463623,937.60196685791016,46.639767408370972,661.08744049072266,-104.63976144790649,1.639117643237114,20.126633048057556,-67.950849294662476,68.431496143341064,7.7380430102348328,17.664523959159851,26.645456314086914,8.9962274730205536,6.3274049162864685,-10.88880980014801,-3.3735213875770569,23.212377905845642,9.1512583494186401,14.34026563167572,19.7087162733078,-14.260555028915405,-8.929220974445343,22.885416984558105,-1.2992345094680786,27.930601716041565,76.999275684356689,-41.889394998550415,117.52799034118652,-98.328952789306641,-286.29487037658691,2010.947868347168,269.49326419830322,1249.0721397399902,226.47568416595459,-205.89575386047363,72.033531188964844,798.11215209960938,-9.4353974461555481,-6.8357149064540863,33.407221555709839,26.808577537536621,-1.8408365249633789,-16.923606634140015,-278.98271369934082,1499.6001434326172],"mode":"lines","line":{"color":"red"},"name":"Predicciones","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>En la gráfica podemos visualizar que la línea negra (datos reales) es bastante estable y se mantiene en valores bajos, mientras que la línea roja (predicciones) muestra mucha más variación y se aleja notablemente de los valores reales en muchos puntos. Se observan picos de predicción de más de 2000, cuando los valores reales no superan los 100 en la mayoría de las observaciones, esto sugiere que el modelo tiene alta varianza y probablemente está sobreajustando o captando ruido en lugar de patrones reales. Aunque los valores reales tienen ligeros picos y cambios, el modelo no los sigue, las predicciones muestran una dinámica completamente diferente, con cambios abruptos que no reflejan la tendencia real, en resumen, el modelo JORDAN no está prediciendo con precisión los valores reales, las predicciones están sobreestimando fuertemente en muchas observaciones.</p>
</div>
</div>
<div id="rendimiento-redes-elman-y-jordan" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Rendimiento Redes ELMAN y JORDAN<a href="redes-neuronales.html#rendimiento-redes-elman-y-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="rendimiento-elman" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Rendimiento ELMAN<a href="redes-neuronales.html#rendimiento-elman" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="redes-neuronales.html#cb101-1" tabindex="-1"></a><span class="co"># Calcular errores</span></span>
<span id="cb101-2"><a href="redes-neuronales.html#cb101-2" tabindex="-1"></a>errores_elman <span class="ot">&lt;-</span> y_test <span class="sc">-</span> predtest1</span>
<span id="cb101-3"><a href="redes-neuronales.html#cb101-3" tabindex="-1"></a></span>
<span id="cb101-4"><a href="redes-neuronales.html#cb101-4" tabindex="-1"></a><span class="co"># Métricas de evaluación</span></span>
<span id="cb101-5"><a href="redes-neuronales.html#cb101-5" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mae</span>(y_test, predtest1)          <span class="co"># Error absoluto medio</span></span>
<span id="cb101-6"><a href="redes-neuronales.html#cb101-6" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">rmse</span>(y_test, predtest1)        <span class="co"># Raíz del error cuadrático medio</span></span>
<span id="cb101-7"><a href="redes-neuronales.html#cb101-7" tabindex="-1"></a>me <span class="ot">&lt;-</span> <span class="fu">mean</span>(errores_elman)                   <span class="co"># Error medio (ME)</span></span>
<span id="cb101-8"><a href="redes-neuronales.html#cb101-8" tabindex="-1"></a>acf1 <span class="ot">&lt;-</span> <span class="fu">acf</span>(errores_elman, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>]  <span class="co"># ACF con rezago 1</span></span>
<span id="cb101-9"><a href="redes-neuronales.html#cb101-9" tabindex="-1"></a></span>
<span id="cb101-10"><a href="redes-neuronales.html#cb101-10" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb101-11"><a href="redes-neuronales.html#cb101-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MAE  :&quot;</span>, <span class="fu">round</span>(mae, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MAE  : 16.7244</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="redes-neuronales.html#cb103-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;RMSE :&quot;</span>, <span class="fu">round</span>(rmse, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## RMSE : 34.0165</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="redes-neuronales.html#cb105-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ME   :&quot;</span>, <span class="fu">round</span>(me, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ME   : 0.2568</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="redes-neuronales.html#cb107-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ACF1 :&quot;</span>, <span class="fu">round</span>(acf1, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ACF1 : -0.081</code></pre>
</div>
<div id="rendimiento-jordan" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Rendimiento Jordan<a href="redes-neuronales.html#rendimiento-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="redes-neuronales.html#cb109-1" tabindex="-1"></a><span class="co"># Calcular errores</span></span>
<span id="cb109-2"><a href="redes-neuronales.html#cb109-2" tabindex="-1"></a>errores_jordan <span class="ot">&lt;-</span> y_j_test <span class="sc">-</span> predtest2</span>
<span id="cb109-3"><a href="redes-neuronales.html#cb109-3" tabindex="-1"></a></span>
<span id="cb109-4"><a href="redes-neuronales.html#cb109-4" tabindex="-1"></a><span class="co"># Métricas de evaluación</span></span>
<span id="cb109-5"><a href="redes-neuronales.html#cb109-5" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mae</span>(y_j_test, predtest2)          <span class="co"># Error absoluto medio</span></span>
<span id="cb109-6"><a href="redes-neuronales.html#cb109-6" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">rmse</span>(y_j_test, predtest2)        <span class="co"># Raíz del error cuadrático medio</span></span>
<span id="cb109-7"><a href="redes-neuronales.html#cb109-7" tabindex="-1"></a>me <span class="ot">&lt;-</span> <span class="fu">mean</span>(errores_jordan)                   <span class="co"># Error medio (ME)</span></span>
<span id="cb109-8"><a href="redes-neuronales.html#cb109-8" tabindex="-1"></a>acf1 <span class="ot">&lt;-</span> <span class="fu">acf</span>(errores_jordan, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>]  <span class="co"># ACF con rezago 1</span></span>
<span id="cb109-9"><a href="redes-neuronales.html#cb109-9" tabindex="-1"></a></span>
<span id="cb109-10"><a href="redes-neuronales.html#cb109-10" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb109-11"><a href="redes-neuronales.html#cb109-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MAE  :&quot;</span>, <span class="fu">round</span>(mae, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MAE  : 172.283</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="redes-neuronales.html#cb111-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;RMSE :&quot;</span>, <span class="fu">round</span>(rmse, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## RMSE : 407.6552</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="redes-neuronales.html#cb113-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ME   :&quot;</span>, <span class="fu">round</span>(me, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ME   : -104.5171</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="redes-neuronales.html#cb115-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ACF1 :&quot;</span>, <span class="fu">round</span>(acf1, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## ACF1 : 0.1833</code></pre>
<p>** MAE (Mean Absolute Error)**</p>
<p>ELMAN: 16.7244 JORDAN: 172.283
- ELMAN muestra un menor error absoluto medio.</p>
<p><strong>RMSE (Root Mean Square Error):</strong>
ELMAN: 34.0165 JORDAN: 407,6752
- ELMAN tiene un RMSE menor, indicando menor variación entre predicciones y valores reales.</p>
<p><strong>ME (Mean Error)</strong>
ELMAN:0.2568 JORDAN: -104.5171
- El modelo JORDAN tiene un error medio más bajo, lo que indica que sus predicciones están, en promedio más cerca de los valores reales.</p>
<p><strong>ACF1 (Autocorrelation of Residuals at Lag 1)</strong>
ELMAN: -0.081 JORDAN: 0.1833
- ELMAN muestra menor autocorrelación en los residuos, indicando que los errores están menos correlacionados y probablemente son más independientes.</p>
<p>Con base en la comparación de métricas de rendimiento, se concluye que el modelo ELMAN supera significativamente al modelo JORDAN en la predicción del ausentismo laboral. ELMAN presenta un MAE (16.72) y un RMSE (34.01) considerablemente menores que los del modelo JORDAN (MAE: 172.28, RMSE: 407.68), lo cual indica un mejor ajuste general y menor dispersión en los errores de predicción.</p>
<p>Aunque JORDAN muestra un ME negativo (-104.51), que podría interpretarse como una menor sobreestimación en promedio, este valor tan alto sugiere una gran desviación sistemática, mientras que el ME de ELMAN (0.25) está cerca de cero, lo que implica predicciones más equilibradas. Además, el menor valor de autocorrelación de los residuos (ACF1) en ELMAN (-0.081) frente a JORDAN (0.1833) indica que los errores del modelo ELMAN están menos correlacionados en el tiempo, y por tanto, es menos probable que haya patrones no capturados en los residuos.</p>
<p>El modelo ELMAN es superior al modelo JORDAN en la mayoria de las métricas analizadas, mostrando menor error y mejor ajuste a los datos reales. Por lo tanto, ELMAN arroja mejores resultado al presentar el mejor rendimiento de los 2 modelos, indicando predicciones más precisas y cercanas a los valores reales del ausentismo laboral. Las redes Elman son bastante útiles para modelar datos secuenciales, ya que pueden incorporar información del contexto previo para realizar mejores predicciones.</p>
</div>
<div id="conclusión-1" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Conclusión<a href="redes-neuronales.html#conclusión-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La red neuronal JORDAN es un tipo de red recurrente que incorpora retroalimentación desde la capa de salida hacia una capa de contexto, lo que le permite mantener una memoria limitada del comportamiento pasado de la serie. Esta capacidad la hace especialmente valiosa en el análisis de series temporales, donde las observaciones anteriores influyen en las futuras. En este caso, en el modelo con los datos de entrenamiento, la red logra seguir la tendencia general en varios tramos, pero presenta picos artificiales extremos que no reflejan los datos reales, así mismo en los datos de prueba, las predicciones son mucho más erráticas y se alejan fuertemente de los valores reales. El modelo memoriza patrones del entrenamiento, pero no logra generalizar a nuevos datos. Esto es un claro indicio de overfitting. Por otro lado, en ambas gráficas, la red genera predicciones con valores extremadamente altos o bajos, incluso cuando los datos reales permanecen estables, este comportamiento sugiere que la red es demasiado sensible a pequeñas variaciones en la entrada o no está correctamente regularizada. La arquitectura o el preprocesamiento pueden estar mal ajustados. Es probable que se necesite una normalización más robusta, menos neuronas ocultas o aplicar regularización. Además, la variable de estudio tiene una dinámica relativamente estable con algunos picos, pero la red JORDAN no logra anticipar ni seguir coherentemente esos patrones. Esto puede deberse a una mala elección del número de rezagos (lags) o a que la red no está explotando bien la dependencia temporal.</p>
<p>ELMAN ofrece mejores resultados al lograr mayor precisión y menor error en las predicciones. Este desempeño se debe a su capacidad para modelar relaciones secuenciales en los datos, haciendo uso de la retroalimentación interna que caracteriza a las redes recurrentes. Por lo tanto en este caso se consideraría una alternativa más robusta para tareas de pronóstico basadas en series temporales como el ausentismo laboral, aunque su predicción tampoco es muy precisa. Es importante considerar aspectos como el sobreajuste (overfitting) y el ajuste de hiperparámetros para asegurar que el modelo ELMAN no solo funcione bien sobre los datos de entrenamiento, sino que también generalice adecuadamente en nuevos datos.</p>
<p>Para optimizar estos parámetros en ELMAN, es recomendable utilizar técnicas como búsqueda en rejilla (grid search) o búsqueda aleatoria (random search), idealmente combinadas con validación cruzada. Estas técnicas permiten explorar combinaciones y encontrar la configuración que proporciona el mejor rendimiento de generalización.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="references.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rortizgeo/TS_bookdown/07-Redes_neuronales.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
