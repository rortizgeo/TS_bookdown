--- 
title: "Análisis de series temporales: Ausentismo laboral"
author: "Ricardo Ortiz; Jaime Martinez, Jeisson Rodriguez"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: rstudio/bookdown-demo
description: "Este es un ejemplo aplicado de análisis de series temporales usando la base de datos de ausentismo laboral disponible en UCI"
---
--- 
title: "Análisis de series temporales: Ausentismo laboral"
author: "Ricardo Ortiz; Jaime Martinez, Jeisson Rodriguez"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: rstudio/bookdown-demo
description: "Este es un ejemplo aplicado de análisis de series temporales usando la base de datos de ausentismo laboral disponible en UCI"
---



```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```

<!--chapter:end:index.Rmd-->


# AUSENTISMO LABORAL

## Introducción

El ausentismo es definido como la ausencia de un empleado en su ambiente laboral con justificación o sin ella [1]. Cuando esto ocurre en una compañía se puede generar un aumento de costos (horas extra) en otros empleados llevando a sobrecarga o desmotivacion [2]. Las causas pueden ser múltiples, desde enfermedades, problemas económicos, razones personales, falta de interés, entre otras [3] En EE. UU. menos de la mitad de las compañías tiene un sistema de rastreo de ausentismo y solo un 16% implementan medidas para reducirlo [4], por esta razón este evento tiene un impacto significativo en el desarrollo financiero de las empresas teniendo un fuerte impacto en la estructura organizacional.

## Finalidad del estudio

El objetivo del análisis de este conjunto de datos es aplicar técnicas de series de tiempo para identificar el comportamiento del ausentismo a través de un periodo de tiempo; esto permitirá desarrrollar estrategias para maximizar la eficiencia operativa de la empresa al identificar los factores asociados al ausentismo laboral.

## Diseño del estudio

La base de datos a utilizar es _Absenteeism at work_ es una base de acceso libre del UCI Machine Learning Repository cuyo dataset contiene información de julio de 2007 a julio de 2010 en una compañia en Brazil [5]. Los datos contienen 740 registros en 19 variables. Esta base de datos posee características que la hacen idónea para la investigación al poseer cobertura conceptual (la información corresponde a la finalidad del estudio), cobertura geográfica (Brazil), cobertura temporal (2007-2010) y amplitud porque en esta fuente de tipo secundario se obtendrá la información de las variables geográficas, demográficas y de otras variables relacionadas con el ausentismo.

Conjunto de datos disponible en: https://archive.ics.uci.edu/dataset/445/absenteeism+at+work 





<!--chapter:end:01-intro.Rmd-->


# Análisis de los datos 

Placeholder


## Media Movil
## Rezagos
## Análísis de estacionalidad
## Descomposición de la serie temporal
## Estacionariedad
## Diferenciación
## Conclusión 

<!--chapter:end:02-literature.Rmd-->

# Predicciones

## Método Holt-Winters


```{r}
#Se instala libreria TSA
library(TSA)
```

Cómo resultado del capítulo 2, se construyó una serie temporal diaria con frecuencia semanal (7 días), que comienza en la semana 1 del ciclo 1 y termina en la semana 53 del ciclo 1. Los valores tienen una distribución asimétrica con muchos ceros (25% de los datos son 0) pero con algunos valores muy altos (hasta 168).

```{r}
#Se verifican características de los datos
class(ts_diaria)
start(ts_diaria)
end(ts_diaria)
frequency(ts_diaria)
summary(ts_diaria)
```
El siguiente gráfico muestra que los datos presentan un comportamiento errático con valores altos de ausentimos en algunas semanas. Sin embargo, la línea generada no muestra una tendencia hacía el aumento o disminución.

```{r}
#Observamos la tendencia y los ciclos
plot(ts_diaria)
abline(reg = lm(ts_diaria~time(ts_diaria)))
```

Para analizar el comportamiento de los datos se intenta realizar una transformación logarítmica. Sin embargo, debido a que la variable de ausencia tiene valores de 0, esta transformación no es posible ya que cuando se trabaja con series temporales donde la variable objetivo contiene ceros, las transformaciones tradicionales como el logaritmo fallan porque log(0) = -∞

En ese sentido, se debe recurrir a otro tipo de transformación que no genere modificaciones profundas en los datos, para ello, se hace uso de una técnica

```{r}

# Versión optimizada (encontrar c óptimo)
c_opt <- min(ts_diaria[ts_diaria > 0])/2  # Mitad del valor mínimo positivo
ts_transf <- log(ts_diaria + c_opt)

#Se usa funcion logaritmica para visualizar los datos
plot(log(ts_transf))
```
Una desventaja de esta transformación es que puede crear un "hueco" artificial entre los ceros transformados y los valores pequeños positivos como se muestra en el gráfico. Adicionalmente, los coeficientes en modelos ajustados a datos transformados requieren interpretación cuidadosa.  Sin embargo estos "huecos" son una representación fiel de la discontinuidad matemática entre cero y valores positivos, además de un indicador visual de la presencia de ceros en los datos originales que puede ser una propiedad deseable en muchos casos, ya que marca claramente la diferencia entre "cero" y "casi cero".

```{r}
#Se crea una nueva serie de datos muy cerca de los datos originales

# Configurar área de gráfico con 2 filas y 1 columna
par(mfrow = c(2, 1), mar = c(4, 4, 2, 1))  # márgenes ajustados

# Primera gráfica (serie original)
hw <- HoltWinters(ts_diaria)
plot(hw, main = "Suavizamiento Holt-Winters - Serie Original")

# Segunda gráfica (serie transformada)
hwt <- HoltWinters(ts_transf)
plot(hwt, main = "Suavizamiento Holt-Winters - Serie Transformada")

# Restaurar configuración gráfica
par(mfrow = c(1, 1))
```

```{r}

# Graficar resultado y se descompone de acuerdo a sus caracteristicas
plot(fitted(hw))
```

Observed (Observada): La serie con el modelo Holt Winters presenta variaciones, con múltiples picos que podrían corresponder a eventos puntuales de alto ausentismo. La serie muestra fluctuaciones regulares, lo que sugiere la presencia de estacionalidad y posiblemente una leve tendencia.

Trend (Tendencia): La tendencia es irregular, pero revela periodos de aumento y disminución del ausentismo a lo largo del tiempo. Se observan tramos donde el nivel general de ausentismo se incrementa al inicio de la semana y antes del fin de semana

Seasonal (Estacionalidad): La componente estacional es clara y bien definida, con un patrón cíclico semanal o cercano al semanal (como fue el caso de la descomposición diaria por día de la semana). Esto sugiere que existe un patrón repetitivo y consistente en el ausentismo, posiblemente relacionado con el inicio o fin de semana, en los que los niveles de ausentismo tienden a aumentar.

Random (Ruido aleatorio): El componente aleatorio muestra picos aislados, lo que indica eventos impredecibles que no pueden explicarse ni por la tendencia ni por la estacionalidad. Es de notar que comparado con los datos originales este metodo de suavizamiento disminuye el ruido presente en la serie


```{r}
#Se realiza una predicion para los proximos 7 días
pred=predict(hw, 7, prediction.interval = TRUE)
pred
```
```{r}
#se visualizan los valores pronosticados para los proximos 7 dias
plot(hw,pred)
```

#Conclusion aplicacion metodologia Holt Winters

La nueva serie de datos aplicando el metodo de suavizamiento exponencial permitio disminuir los picos  que se observaban en el  modelo original permitiendo disminuir el ruido y mostrando un modelo predictivo que apunta al ausentismo laboral en el comienzo y final de la semana

<!--chapter:end:03-method.Rmd-->

.

<!--chapter:end:04-application.Rmd-->

.

<!--chapter:end:05-summary.Rmd-->

`r if (knitr:::is_html_output()) '
# References {-}
'`

[1] Mowday RT, Porter LW, Steers RM (2013) Employee organization linkages: the psychology of commitment, absenteeism, and turnover. Academic press, New York

[2] De Stobbeleir KE, De Clippeleer I, Caniëls MC, Goedertier F, Deprez J, De Vos A, Buyens D (2018) The inside effects of a strong external employer brand: how external perceptions can influ ence organizational absenteeism rates. Int J Hum Resour Manag 29:2106–2136.

[3] Gonzalez BD, Grandner MA, Caminiti CB, Hui SA (2018) Cancer survivors in the workplace: sleep disturbance mediates the impact of cancer on healthcare expenditures and work absenteeism. Support Care Cancer 26:4049–4055.

[4] Kocakulah, M. C., Kelley, A. G., Mitchell, K. M., & Ruggieri, M. P. (2016). Absenteeism problems and costs: causes, effects and cures. The International Business & Economics Research Journal (Online), 15(3), 89.

[5] D. Dua and C. Graff, "Absenteeism at work Data Set," UCI Machine Learning Repository, 2019. [Online]. Available: https://archive.ics.uci.edu/ml/datasets/Absenteeism+at+work

<!--chapter:end:06-references.Rmd-->

